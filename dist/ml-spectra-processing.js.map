{"version":3,"file":"ml-spectra-processing.js","sources":["../node_modules/is-any-array/src/index.js","../lib/index.js"],"sourcesContent":["'use strict';\n\nconst toString = Object.prototype.toString;\n\nfunction isAnyArray(object) {\n  return toString.call(object).endsWith('Array]');\n}\n\nmodule.exports = isAnyArray;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nconst isAnyArray = require('is-any-array');\n\n/**\n * Throw an error in no an object of x,y arrays\n * @param {object} [points={}]\n */\nfunction check(points = {}) {\n  if (!isAnyArray(points.x) || !isAnyArray(points.y)) {\n    throw new Error('Points must be an object of x and y arrays');\n  }\n  if (points.x.length !== points.y.length) {\n    throw new Error('The x and y arrays mush have the same length');\n  }\n}\n\n/**\n * Returns the closest index of a `target` in an ordered array\n * @param {array} array\n * @param {number} target\n */\n\nfunction findClosestIndex(array, target) {\n  let low = 0;\n  let high = array.length - 1;\n  let middle = 0;\n  while (high - low > 1) {\n    middle = low + ((high - low) >> 1);\n    if (array[middle] < target) {\n      low = middle;\n    } else if (array[middle] > target) {\n      high = middle;\n    } else {\n      return middle;\n    }\n  }\n\n  if (low < array.length - 1) {\n    if (Math.abs(target - array[low]) < Math.abs(array[low + 1] - target)) {\n      return low;\n    } else {\n      return low + 1;\n    }\n  } else {\n    return low;\n  }\n}\n\n/**\n * Returns an object with {fromIndex, toIndex} for a specific from / to\n * @param {array} x\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n */\n\nfunction getFromToIndex(x, options = {}) {\n  let { fromIndex, toIndex, from, to } = options;\n\n  if (fromIndex === undefined) {\n    if (from !== undefined) {\n      fromIndex = findClosestIndex(x, from);\n    } else {\n      fromIndex = 0;\n    }\n  }\n  if (toIndex === undefined) {\n    if (to !== undefined) {\n      toIndex = findClosestIndex(x, to);\n    } else {\n      toIndex = x.length - 1;\n    }\n  }\n  if (fromIndex > toIndex) [fromIndex, toIndex] = [toIndex, fromIndex];\n  return { fromIndex, toIndex };\n}\n\n/**\n * In place modification of the 2 arrays to make X unique and sum the Y if X has the same value\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {number} Integration value on the specified range\n */\n\nfunction integration(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n  let integration = 0;\n  for (let i = fromIndex; i < toIndex; i++) {\n    integration += ((x[i + 1] - x[i]) * (y[i + 1] + y[i])) / 2;\n  }\n\n  return integration;\n}\n\n/**\n * Generate a X / Y of the integral\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @param {boolean} [options.reverse=false] - Integrate from the larger value to the smallest value\n * @return {{x:[],y:[]}} An object with the integration function\n */\n\nfunction integral(points = {}, options = {}) {\n  const { reverse = false } = options;\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let integration = 0;\n  let integral;\n  if (reverse) {\n    integral = { x: [x[toIndex]], y: [0] };\n    for (let i = toIndex; i > fromIndex; i--) {\n      integration += ((x[i] - x[i - 1]) * (y[i - 1] + y[i])) / 2;\n      integral.x.push(x[i - 1]);\n      integral.y.push(integration);\n    }\n    integral.x.reverse();\n    integral.y.reverse();\n  } else {\n    integral = { x: [x[fromIndex]], y: [0] };\n    for (let i = fromIndex; i < toIndex; i++) {\n      integration += ((x[i + 1] - x[i]) * (y[i + 1] + y[i])) / 2;\n      integral.x.push(x[i + 1]);\n      integral.y.push(integration);\n    }\n  }\n\n  return integral;\n}\n\n/**\n * Finds the max value in a zone\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {number} Max y on the specified range\n */\n\nfunction maxY(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let maxY = y[fromIndex];\n  for (let i = fromIndex; i <= toIndex; i++) {\n    if (y[i] > maxY) maxY = y[i];\n  }\n\n  return maxY;\n}\n\n/**\n * Finds the max y value in a range and return a {x,y} point\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {object}\n */\n\nfunction maxYPoint(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let current = { x: x[fromIndex], y: y[fromIndex], index: fromIndex };\n  for (let i = fromIndex; i <= toIndex; i++) {\n    if (y[i] > current.y) current = { x: x[i], y: y[i], index: i };\n  }\n\n  return current;\n}\n\n/**\n * Finds the max y value in a range and return a {x,y} point\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {object}\n */\n\nfunction minYPoint(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let current = { x: x[fromIndex], y: y[fromIndex], index: fromIndex };\n  for (let i = fromIndex; i <= toIndex; i++) {\n    if (y[i] < current.y) current = { x: x[i], y: y[i], index: i };\n  }\n\n  return current;\n}\n\n/**\n * Reduce the number of points while keeping visually the same noise. Practical to\n * display many spectra as SVG\n * @param {array} x\n * @param {array} y\n * @param {object} [options={}]\n * @param {number} [options.from=x[0]]\n * @param {number} [options.to=x[x.length-1]]\n * @param {number} [options.nbPoints=4001] Number of points\n * @param {number} [options.optimize=false] If optimize we may have less than nbPoints at the end\n */\n\nfunction reduce(x, y, options = {}) {\n  let {\n    from = x[0],\n    to = x[x.length - 1],\n    nbPoints = 4001,\n    optimize = false,\n  } = options;\n\n  let fromIndex = findClosestIndex(x, from);\n  let toIndex = findClosestIndex(x, to);\n\n  if (fromIndex > 0 && x[fromIndex] > from) fromIndex--;\n  if (toIndex < x.length - 1 && x[toIndex] < to) toIndex++;\n\n  if (toIndex - fromIndex < nbPoints) {\n    return {\n      x: x.slice(fromIndex, toIndex + 1),\n      y: y.slice(fromIndex, toIndex + 1),\n    };\n  }\n\n  let newX = [x[fromIndex]];\n  let newY = [y[fromIndex]];\n  let minY = Number.MAX_VALUE;\n  let maxY = Number.MIN_VALUE;\n  if (nbPoints % 2 === 0) {\n    nbPoints = nbPoints / 2 + 1;\n  } else {\n    nbPoints = (nbPoints - 1) / 2 + 1;\n  }\n\n  let slot = (x[toIndex] - x[fromIndex]) / (nbPoints - 1);\n  let currentX = x[fromIndex] + slot;\n  let first = true;\n  for (let i = fromIndex + 1; i <= toIndex; i++) {\n    if (first) {\n      minY = y[i];\n      maxY = y[i];\n      first = false;\n    } else {\n      if (y[i] < minY) minY = y[i];\n      if (y[i] > maxY) maxY = y[i];\n    }\n    if (x[i] >= currentX || i === toIndex) {\n      if (optimize) {\n        if (minY > newY[newX.length - 1]) ; else if (maxY < newY[newX.length - 1]) {\n          // we can skip the intermediate value\n          maxY = minY;\n        } else {\n          newX.push(currentX - slot / 2);\n          newY.push(minY);\n        }\n      } else {\n        newX.push(currentX - slot / 2);\n        newY.push(minY);\n      }\n\n      newX.push(currentX);\n      newY.push(maxY);\n\n      currentX += slot;\n      first = true;\n    }\n  }\n\n  // we will need to make some kind of min / max because there are too many points\n  // we will always keep the first point and the last point\n\n  return { x: newX, y: newY };\n}\n\n/**\n * Order object of array, x has to be monotone.\n * Ensure x is growing\n * @param {object} data Object of kind {x:[], y:[]}.\n * @return {SD}\n */\n\nfunction growingX(data) {\n  const { x, y } = data;\n\n  if (x.length !== y.length) {\n    throw TypeError('sortX: length of x and y must be identical');\n  }\n\n  if (x.length < 2 || x[0] < x[1]) return data;\n\n  return {\n    x: x.slice(0).reverse(),\n    y: y.slice(0).reverse(),\n  };\n}\n\n/**\n * Find the closest minimum going down hill\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @return {{x,y,xIndex}} An object with the x/y value\n */\n\nfunction minClosestYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n\n  let { target, targetIndex } = options;\n\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      targetIndex = findClosestIndex(x, target);\n    } else {\n      targetIndex = 0;\n    }\n  }\n\n  let previousIndex = Number.MIN_SAFE_INTEGER;\n  let currentIndex = targetIndex;\n\n  let minY = y[targetIndex];\n\n  while (currentIndex !== previousIndex) {\n    previousIndex = currentIndex;\n    if (currentIndex > 0 && y[currentIndex - 1] < minY) {\n      currentIndex--;\n    } else if (currentIndex < x.length - 1 && y[currentIndex + 1] < minY) {\n      currentIndex++;\n    }\n    minY = y[currentIndex];\n  }\n  return {\n    x: x[currentIndex],\n    y: y[currentIndex],\n    index: currentIndex,\n  };\n}\n\n/**\n * Find the closest maximum going up hill\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @return {{x,y,xIndex}} An object with the x/y value\n */\n\nfunction maxClosestYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n\n  let { target, targetIndex } = options;\n\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      targetIndex = findClosestIndex(x, target);\n    } else {\n      targetIndex = 0;\n    }\n  }\n\n  let previousIndex = Number.MIN_SAFE_INTEGER;\n  let currentIndex = targetIndex;\n\n  let maxY = y[targetIndex];\n\n  while (currentIndex !== previousIndex) {\n    previousIndex = currentIndex;\n    if (currentIndex > 0 && y[currentIndex - 1] > maxY) {\n      currentIndex--;\n    } else if (currentIndex < x.length - 1 && y[currentIndex + 1] > maxY) {\n      currentIndex++;\n    }\n    maxY = y[currentIndex];\n  }\n  return {\n    x: x[currentIndex],\n    y: y[currentIndex],\n    index: currentIndex,\n  };\n}\n\n/**\n *  Returns the targetIndex\n * @param {array} [x]\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @param {number}\n */\n\nfunction getTargetIndex(x, options = {}) {\n  let { target, targetIndex } = options;\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      return findClosestIndex(x, target);\n    } else {\n      return 0;\n    }\n  }\n  return targetIndex;\n}\n\nfunction realMinYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n\n  const targetIndex = getTargetIndex(x, options);\n  // interpolation to a sin() function\n  if (\n    y[targetIndex - 1] < 0 &&\n    y[targetIndex + 1] < 0 &&\n    y[targetIndex] <= y[targetIndex - 1] &&\n    y[targetIndex] <= y[targetIndex + 1]\n  ) {\n    let alpha = 20 * Math.log10(-y[targetIndex - 1]);\n    let beta = 20 * Math.log10(-y[targetIndex]);\n    let gamma = 20 * Math.log10(-y[targetIndex + 1]);\n    let p = (0.5 * (alpha - gamma)) / (alpha - 2 * beta + gamma);\n    return {\n      x: x[targetIndex] + (x[targetIndex] - x[targetIndex - 1]) * p,\n      y: y[targetIndex] - 0.25 * (y[targetIndex - 1] - y[targetIndex + 1]) * p,\n      index: targetIndex,\n    };\n  } else {\n    return {\n      x: x[targetIndex],\n      y: y[targetIndex],\n      index: targetIndex,\n    };\n  }\n}\n\n/**\n * Find the closest minimum going down hill\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @return {{x,y,xIndex}} An object with the x/y value\n */\n\nfunction realMaxYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n  const targetIndex = getTargetIndex(x, options);\n  // interpolation to a sin() function\n  if (\n    y[targetIndex - 1] > 0 &&\n    y[targetIndex + 1] > 0 &&\n    y[targetIndex] >= y[targetIndex - 1] &&\n    y[targetIndex] >= y[targetIndex + 1]\n  ) {\n    let alpha = 20 * Math.log10(y[targetIndex - 1]);\n    let beta = 20 * Math.log10(y[targetIndex]);\n    let gamma = 20 * Math.log10(y[targetIndex + 1]);\n    let p = (0.5 * (alpha - gamma)) / (alpha - 2 * beta + gamma);\n    return {\n      x: x[targetIndex] + (x[targetIndex] - x[targetIndex - 1]) * p,\n      y: y[targetIndex] - 0.25 * (y[targetIndex - 1] - y[targetIndex + 1]) * p,\n      index: targetIndex,\n    };\n  } else {\n    return {\n      x: x[targetIndex],\n      y: y[targetIndex],\n      index: targetIndex,\n    };\n  }\n}\n\n/**\n * Finds all the max values\n * If the values are equal the middle\n * of the equal part will be the position of the signal!\n *\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @return {Array} Array of points\n */\n\nfunction maximaY(points = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 3) return [];\n  let maxima = [];\n  let startEqualIndex = -1;\n  for (let i = 1; i < x.length - 1; i++) {\n    if (y[i - 1] < y[i] && y[i + 1] < y[i]) {\n      maxima.push({ x: x[i], y: y[i], index: i });\n    } else if (y[i - 1] < y[i] && y[i + 1] === y[i]) {\n      startEqualIndex = i;\n    } else if (y[i - 1] === y[i] && y[i + 1] < y[i]) {\n      let index = ((i + startEqualIndex) / 2) >> 0;\n      maxima.push({ x: x[index], y: y[index], index });\n    }\n  }\n  return maxima;\n}\n\n/**\n * Finds all the min values\n * If the values are equal the middle\n * of the equal part will be the position of the signal!\n *\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @return {Array} Array of points\n */\n\nfunction minimaY(points = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 3) return [];\n  let maxima = [];\n  let startEqualIndex = -1;\n  for (let i = 1; i < x.length - 1; i++) {\n    if (y[i - 1] > y[i] && y[i + 1] > y[i]) {\n      maxima.push({ x: x[i], y: y[i], index: i });\n    } else if (y[i - 1] > y[i] && y[i + 1] === y[i]) {\n      startEqualIndex = i;\n    } else if (y[i - 1] === y[i] && y[i + 1] > y[i]) {\n      let index = ((i + startEqualIndex) / 2) >> 0;\n      maxima.push({ x: x[index], y: y[index], index });\n    }\n  }\n  return maxima;\n}\n\n/**\n * Returns an information about a signal\n *\n * We expect ordered data and equidistant X axis\n * You can use the method helper if required:\n * ML.ArrayXY.uniqueX\n * ML.ArrayXY.sortX\n * ML.ArrayXY.equallySpaced\n *\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex]\n * @return {object} Information about signal\n */\n\nfunction peakInfo(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 3) return undefined;\n  let { targetIndex, target } = options;\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      targetIndex = findClosestIndex(x, target);\n    }\n  }\n\n  if (targetIndex === undefined) {\n    throw new Error('peakInfo: need to specify target or targetIndex');\n  }\n\n  let i = targetIndex;\n  let currentDiff = y[i] - y[i + 1];\n\n  let multiplier = currentDiff < 0 ? -1 : 1;\n  currentDiff *= multiplier;\n  while (i < x.length - 1) {\n    i++;\n    let newDiff = (y[i] - y[i + 1]) * multiplier;\n    if (newDiff < currentDiff) break;\n    currentDiff = newDiff;\n  }\n  let after = { x: x[i], y: y[i] };\n\n  i = targetIndex;\n  currentDiff = (y[i] - y[i - 1]) * multiplier;\n  while (i > 1) {\n    i--;\n    let newDiff = (y[i] - y[i - 1]) * multiplier;\n    if (newDiff < currentDiff) break;\n    currentDiff = newDiff;\n  }\n  let before = { x: x[i], y: y[i] };\n\n  return {\n    inflectionBefore: before,\n    inflectionAfter: after,\n    extrema: { x: x[targetIndex], y: y[targetIndex] },\n    inflectionMiddle: {\n      x: (before.x + after.x) / 2,\n      y: (before.y + after.y) / 2,\n    },\n    width: Math.abs(before.x - after.x),\n  };\n}\n\n/**\n *\n * @param {array} [data] array of points {x,y}\n */\nfunction toXYObject(points) {\n  check(points);\n  const { x, y } = points;\n  let data = [];\n  for (let i = 0; i < x.length; i++) {\n    data.push({ x: x[i], y: y[i] });\n  }\n  return data;\n}\n\nconst XY = {\n  check,\n  integral,\n  integration,\n  maxY,\n  maximaY,\n  maxYPoint,\n  minimaY,\n  minYPoint,\n  reduce,\n  growingX,\n  minClosestYPoint,\n  maxClosestYPoint,\n  realMaxYPoint,\n  realMinYPoint,\n  peakInfo,\n  toXYObject,\n};\n\n/**\n * This function make a zero filling to re and im part.\n * @param {object} data Object of kind {x:[], re:[], im:[]}.\n * @param {number} zeroFilling - final number of points\n * @return {SD}\n */\nfunction zeroFilling(data, zeroFilling) {\n  let length = data.x.length;\n  if (zeroFilling === 0 || length === zeroFilling) return data;\n\n  if (length > zeroFilling) {\n    return {\n      x: data.x.slice(0, zeroFilling),\n      re: data.re.slice(0, zeroFilling),\n      im: data.im.slice(0, zeroFilling),\n    };\n  }\n\n  const x = data.x;\n  const re = data.re;\n  const im = data.im;\n\n  const newX = new Float64Array(zeroFilling);\n  const newRE = new Float64Array(zeroFilling);\n  const newIM = new Float64Array(zeroFilling);\n\n  for (let i = 0; i < length; i++) {\n    newX[i] = x[i];\n    newRE[i] = re[i];\n    newIM[i] = im[i];\n  }\n  const deltaX = (x[x.length - 1] - x[0]) / (length - 1);\n  for (let i = length; i < zeroFilling; i++) {\n    newX[i] = newX[i - 1] + deltaX;\n  }\n\n  return {\n    x: newX,\n    re: newRE,\n    im: newIM,\n  };\n}\n\n/**\n * Sort object of array, x has to be monotone.\n * @param {object} data Object of kind {x:[], re:[], im:[]}.\n * @return {SD}\n */\n\nfunction sortX(data) {\n  const { x, re, im } = data;\n\n  if (x.length !== re.length || x.length !== im.length) {\n    throw TypeError('sortX: length of x, re and im must be identical');\n  }\n\n  if (x.length < 2 || x[0] < x[1]) return data;\n\n  return {\n    x: x.slice(0).reverse(),\n    re: re.slice(0).reverse(),\n    im: im.slice(0).reverse(),\n  };\n}\n\nconst XReIm = {\n  zeroFilling,\n  sortX,\n};\n\n/**\n * Calculate absolute value of a spectrum\n * @param {object} reim - An object of kind {re:[], im:[]}\n * @return {Float64Array}\n */\nfunction absolute(data) {\n  const length = data.re.length;\n  const re = data.re;\n  const im = data.im;\n  const newArray = new Float64Array(length);\n  for (let i = 0; i < length; i++) {\n    newArray[i] = Math.sqrt(re[i] ** 2 + im[i] ** 2);\n  }\n\n  return newArray;\n}\n\n/**\n * Phase correction filter\n * @param {object} reim - An object of kind {re:[], im:[]}\n * @param {number} [phi0 = 0] - Angle in radians for zero order phase correction\n * @param {number} [phi1 = 0] - Angle in radians for first order phase correction\n * @return {object} returns a new object {re:[], im:[]}\n */\nfunction phaseCorrection(data, phi0, phi1) {\n  phi0 = Number.isFinite(phi0) ? phi0 : 0;\n  phi1 = Number.isFinite(phi1) ? phi1 : 0;\n\n  const re = data.re;\n  const im = data.im;\n  const length = data.re.length;\n\n  const delta = phi1 / length;\n  const alpha = 2 * Math.pow(Math.sin(delta / 2), 2);\n  const beta = Math.sin(delta);\n  let cosTheta = Math.cos(phi0);\n  let sinTheta = Math.sin(phi0);\n\n  const newRe = new Float64Array(length);\n  const newIm = new Float64Array(length);\n  for (let i = 0; i < length; i++) {\n    newRe[i] = re[i] * cosTheta - im[i] * sinTheta;\n    newIm[i] = re[i] * sinTheta + im[i] * cosTheta;\n    // calculate angles i+1 from i\n    cosTheta = cosTheta - (alpha * cosTheta + beta * sinTheta);\n    sinTheta = sinTheta - (alpha * sinTheta - beta * cosTheta);\n  }\n\n  return { re: newRe, im: newIm };\n}\n\nconst ReIm = {\n  absolute,\n  phaseCorrection,\n};\n\n/**\n\n/**\n * This function add the first array by the second array or a constant value to each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nfunction add(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] + constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] + array2[i];\n    }\n  }\n\n  return array3;\n}\n\n/**\n * This function subtract the first array by the second array or a constant value from each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @return {object}\n */\nfunction boxPlot(array) {\n  array = array.slice(0).sort((a, b) => a - b);\n  if (array.length < 5) {\n    throw Error(\n      'boxPlot: can not calculate info if array contains less than 3 elements',\n    );\n  }\n  let info = {\n    Q1: 0.0,\n    Q2: 0.0,\n    Q3: 0.0,\n    min: array[0],\n    max: array[array.length - 1],\n  };\n  let q1max, q3min;\n  if (array.length % 2 === 1) {\n    // odd\n    let middle = (array.length - 1) / 2;\n    info.Q2 = array[middle];\n    q1max = middle - 1;\n    q3min = middle + 1;\n  } else {\n    // even\n    q3min = array.length / 2;\n    q1max = q3min - 1;\n    info.Q2 = (array[q1max] + array[q3min]) / 2;\n  }\n  if (q1max % 2 === 0) {\n    info.Q1 = array[q1max / 2];\n    info.Q3 = array[(array.length + q3min - 1) / 2];\n  } else {\n    info.Q1 = (array[(q1max + 1) / 2] + array[(q1max - 1) / 2]) / 2;\n    let middleOver = (array.length + q3min) / 2;\n    info.Q3 = (array[middleOver] + array[middleOver - 1]) / 2;\n  }\n  return info;\n}\n\n/**\n\n/**\n * Calculates the correlation between 2 vectors\n * https://en.wikipedia.org/wiki/Correlation_and_dependence\n *\n * @param {Array} [A] - the array that will be rotated\n * @param {Array} [B]\n * @return {Array}\n */\nfunction correlation(A, B) {\n  let n = A.length;\n  let sumA = 0;\n  let sumA2 = 0;\n  let sumB = 0;\n  let sumB2 = 0;\n  let sumAB = 0;\n  for (let i = 0; i < n; i++) {\n    let a = A[i];\n    let b = B[i];\n    sumA += a;\n    sumA2 += a ** 2;\n    sumB += b;\n    sumB2 += b ** 2;\n    sumAB += a * b;\n  }\n  return (\n    (n * sumAB - sumA * sumB) /\n    (Math.sqrt(n * sumA2 - sumA ** 2) * Math.sqrt(n * sumB2 - sumB ** 2))\n  );\n}\n\n/**\n\n/**\n * This function divide the first array by the second array or a constant value to each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nfunction divide(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] / constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] / array2[i];\n    }\n  }\n\n  return array3;\n}\n\n/**\n\n/**\n * This function multiply the first array by the second array or a constant value to each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nfunction multiply(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] * constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] * array2[i];\n    }\n  }\n\n  return array3;\n}\n\n/**\n * This function performs a circular shift to a new array\n * Positive values of shifts will shift to the right and negative values will do to the left\n * @example rotate([1,2,3,4],1) -> [4,1,2,3]\n * @example rotate([1,2,3,4],-1) -> [2,3,4,1]\n * @param {Array} array - the array that will be rotated\n * @param {number} shift\n * @return {Array}\n */\nfunction rotate(array, shift) {\n  shift = shift % array.length;\n  if (shift < 0) shift += array.length;\n  return array\n    .slice(array.length - shift)\n    .concat(array.slice(0, array.length - shift));\n}\n\n/**\n * This function subtract the first array by the second array or a constant value from each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nfunction subtract(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] - constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] - array2[i];\n    }\n  }\n\n  return array3;\n}\n\nconst X = {\n  add,\n  boxPlot,\n  correlation,\n  divide,\n  findClosestIndex,\n  getFromToIndex,\n  getTargetIndex,\n  multiply,\n  rotate,\n  subtract,\n};\n\n/**\n *\n * @param {array} [data] array of growing points {x,y}\n * @param {object} [options={}]\n * @param {object} [xError=Number.EPSILON] limit to join the data\n */\nfunction joinX(data, options = {}) {\n  const { xError = Number.EPSILON } = options;\n\n  // when we join we will use the center of mass\n  let result = [];\n  let current = {\n    x: Number.MIN_SAFE_INTEGER,\n    y: 0,\n  };\n  for (let item of data) {\n    if (item.x - current.x <= xError) {\n      // weighted sum\n      current.x =\n        (item.y / (current.y + item.y)) * (item.x - current.x) + current.x;\n      current.y += item.y;\n    } else {\n      current = {\n        x: item.x,\n        y: item.y,\n      };\n      result.push(current);\n    }\n  }\n  return result;\n}\n\n/**\n *\n * @param {array} [data] array of growing points {x,y}\n * @param {object} [options={}]\n * @param {object} [slotWidth=1] limit to join the data\n */\nfunction slotX(data, options = {}) {\n  const { slotWidth = 1 } = options;\n  const halfSlot = slotWidth / 2;\n\n  // when we join we will use the center of mass\n  let result = [];\n  let current = {\n    x: Number.MIN_VALUE,\n    y: 0,\n  };\n  for (let item of data) {\n    let slot = item.x - ((item.x + halfSlot) % slotWidth) + halfSlot;\n    if (Math.abs(current.x - slot) > Number.EPSILON) {\n      current = {\n        x: slot,\n        y: 0,\n      };\n      result.push(current);\n    }\n    current.y += item.y;\n  }\n  return result;\n}\n\n/**\n * Sorts an array of points\n * @param {array} [data] array of points {x,y}\n */\n\nfunction sortX$1(data) {\n  return data.sort((a, b) => a.x - b.x);\n}\n\n/**\n *\n * @param {array} [data] array of points {x,y}\n */\nfunction toXY(data) {\n  return {\n    x: data.map((entry) => entry.x),\n    y: data.map((entry) => entry.y),\n  };\n}\n\nconst XYObject = {\n  joinX,\n  slotX,\n  sortX: sortX$1,\n  toXY,\n};\n\nexports.ReIm = ReIm;\nexports.X = X;\nexports.XReIm = XReIm;\nexports.XY = XY;\nexports.XYObject = XYObject;\n"],"names":["toString","Object","prototype","isAnyArray","object","call","endsWith","defineProperty","exports","value","check","points","x","y","Error","length","findClosestIndex","array","target","low","high","middle","Math","abs","getFromToIndex","options","fromIndex","toIndex","from","to","undefined","integration","i","integral","reverse","push","maxY","maxYPoint","current","index","minYPoint","reduce","nbPoints","optimize","slice","newX","newY","minY","Number","MAX_VALUE","MIN_VALUE","slot","currentX","first","growingX","data","TypeError","minClosestYPoint","targetIndex","previousIndex","MIN_SAFE_INTEGER","currentIndex","maxClosestYPoint","getTargetIndex","realMinYPoint","alpha","log10","beta","gamma","p","realMaxYPoint","maximaY","maxima","startEqualIndex","minimaY","peakInfo","currentDiff","multiplier","newDiff","after","before","inflectionBefore","inflectionAfter","extrema","inflectionMiddle","width","toXYObject","XY","zeroFilling","re","im","Float64Array","newRE","newIM","deltaX","sortX","XReIm","absolute","newArray","sqrt","phaseCorrection","phi0","phi1","isFinite","delta","pow","sin","cosTheta","cos","sinTheta","newRe","newIm","ReIm","add","array1","array2","isConstant","constant","Array","isArray","array3","boxPlot","sort","a","b","info","Q1","Q2","Q3","min","max","q1max","q3min","middleOver","correlation","A","B","n","sumA","sumA2","sumB","sumB2","sumAB","divide","multiply","rotate","shift","concat","subtract","X","joinX","xError","EPSILON","result","item","slotX","slotWidth","halfSlot","sortX$1","toXY","map","entry","XYObject"],"mappings":"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"}