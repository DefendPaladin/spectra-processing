!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).SpectraProcessing={})}(this,(function(t){"use strict";const e=Object.prototype.toString;var r=function(t){return e.call(t).endsWith("Array]")};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function n(t,e){return t(e={exports:{}},e.exports),e.exports}var i=n((function(t){!function(){function e(t){for(var e=0,i=t.length-1,o=void 0,a=void 0,s=void 0,l=n(e,i);;){if(i<=e)return t[l];if(i==e+1)return t[e]>t[i]&&r(t,e,i),t[l];for(t[o=n(e,i)]>t[i]&&r(t,o,i),t[e]>t[i]&&r(t,e,i),t[o]>t[e]&&r(t,o,e),r(t,o,e+1),a=e+1,s=i;;){do{a++}while(t[e]>t[a]);do{s--}while(t[s]>t[e]);if(s<a)break;r(t,a,s)}r(t,e,s),s<=l&&(e=a),s>=l&&(i=s-1)}}var r=function(t,e,r){var n;return n=[t[r],t[e]],t[e]=n[0],t[r]=n[1],n},n=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()}));function o(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Float64Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]*r;else for(let r=0;r<t.length;r++)i[r]=t[r]*e[r];return i}function a(t,e){let r=o(t,e),n=0;for(let e=0;e<t.length;e++)n+=r[e];return n}function s(t,e,r={}){let{tau:n=1,lag:i=t.length-1}=r,o=new Float64Array(1+2*i/n);if(t.length===e.length){let r=e.length,s=new Float64Array(2*r),l=new Float64Array(2*r);for(let t=0;t<r;t++)l[r+t]=e[t];for(let e=2*r-(n-1);e>0;e-=n){let u=0;for(let t=e;t<2*r;t++)s[u]=l[t],u++;let f=[];for(let t=0;t<r;t++)f[t]=s[t];o[(u-(r-i))/n]=a(t,f)}}return o}function l(t,e){let r=0,n=t.length-1,i=0;for(;n-r>1;)if(i=r+(n-r>>1),t[i]<e)r=i;else{if(!(t[i]>e))return i;n=i}return r<t.length-1?Math.abs(e-t[r])<Math.abs(t[r+1]-e)?r:r+1:r}function u(t,e={}){let{fromIndex:r,toIndex:n,from:i,to:o}=e;return void 0===r&&(r=void 0!==i?l(t,i):0),void 0===n&&(n=void 0!==o?l(t,o):t.length-1),r>n&&([r,n]=[n,r]),{fromIndex:r,toIndex:n}}var f=function(t){return"number"==typeof t&&t==t};var h=function(t){return("number"==typeof t||"[object Number]"===Object.prototype.toString.call(t))&&t.valueOf()!=t.valueOf()};var p=function(t){return f(t)&&t%1==0};var c=function(t){return null!=t&&"function"!=typeof t&&p(t.length)&&t.length>=0&&t.length<=4294967295};var y=function(t){return null!==t&&"object"==typeof t&&p(t.length)&&t.length>=0&&t.length<=4294967295&&"number"==typeof t.BYTES_PER_ELEMENT&&"number"==typeof t.byteOffset&&"number"==typeof t.byteLength};var d=function(t){return null!==t&&"object"==typeof t&&"object"==typeof t.data&&"object"==typeof t.shape&&"number"==typeof t.offset&&"object"==typeof t.strides&&"string"==typeof t.dtype&&"number"==typeof t.length},g={int8:Int8Array,uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,generic:Array};var m=function(t){return g[t]||null};var v=function(t){return"string"==typeof t};var w=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};var b=function(t){return("number"==typeof t||"[object Number]"===Object.prototype.toString.call(t))&&t.valueOf()==t.valueOf()};var x=function(t){return b(t)&&t%1==0};var A=function(t){return x(t)&&t>=0};var E=function(t){var e;if(!w(t))return!1;if(!(e=t.length))return!1;for(var r=0;r<e;r++)if(!A(t[r]))return!1;return!0};var O=function(t){return"number"==typeof t&&t!=t};var M=function(t,e){var r,n;if(!w(t))throw new TypeError("contains()::invalid input argument. First argument must be an array. Value: `"+t+"`.");if(r=t.length,O(e)){for(n=0;n<r;n++)if(O(t[n]))return!0;return!1}for(n=0;n<r;n++)if(t[n]===e)return!0;return!1},I=Object.prototype.toString;var j=function(t){var e,r,n,i;return null===t?"null":"object"===(e=typeof t)?(r=t,"Object"===(i=I.call(r).slice(8,-1))&&r.constructor?(n=r.constructor).name?n.name:/^\s*function\s*([^\(]*)/im.exec(n.toString())[1]:i):e},T={Int8Array:"int8",Uint8Array:"uint8",Uint8ClampedArray:"uint8_clamped",Int16Array:"int16",Uint16Array:"uint16",Int32Array:"int32",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"generic"};var N=function(t){return T[t]||null},_={int8:Int8Array,uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,generic:Array};var P=function(t){return _[t]||null};var S=function(t,e){var r,n,i,o;if(!c(t))throw new TypeError("invalid input argument. First argument must be an array-like object. Value: `"+t+"`.");if(null===(r=P("string"==typeof e?e:N(j(e)))))throw new Error("invalid input argument. Unrecognized/unsupported type to which to cast. Value: `"+e+"`.");if(n=t.length,"generic"===e&&n>64e3){for(i=new r(64e3),o=0;o<64e3;o++)i[o]=t[o];for(o=64e3;o<n;o++)i.push(t[o])}else for(i=new r(n),o=0;o<n;o++)i[o]=t[o];return i},F={Int8Array:"int8",Uint8Array:"uint8",Uint8ClampedArray:"uint8_clamped",Int16Array:"int16",Uint16Array:"uint16",Int32Array:"int32",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"generic"};var V=function(t){return F[t]||null};var k=function(t){var e;if(null===t)return"null";switch(e=typeof t){case"undefined":case"boolean":case"number":case"string":case"function":case"symbol":return e}return e=j(t),V(e)||("Buffer"===e||"ArrayBuffer"===e?"binary":"generic")};var z=function(t,e,r){if(!A(t)||!A(e))throw new TypeError("invalid input argument. Row and column indices must be nonnegative integers. Values: `["+t+","+e+"]`.");if(!f(r)&&!h(r))throw new TypeError("invalid input argument. An input value must be a number primitive. Value: `"+r+"`.");return(t=this.offset+t*this.strides[0]+e*this.strides[1])>=0&&(this.data[t]=r),this};var C=function(t,e){var r,n;if(!p(t))throw new TypeError("invalid input argument. An index must be an integer. Value: `"+t+"`.");if(!f(e)&&!h(e))throw new TypeError("invalid input argument. An input value must be a number primitive. Value: `"+e+"`.");return t<0&&(t+=this.length)<0||(r=t-(n=t%this.strides[0]),this.strides[0]<0&&(r=-r),this.data[this.offset+r+n*this.strides[1]]=e),this};var U=function(t){return"function"==typeof t};var R=function(t,e,r){var n,i,o,a,s=t.strides[0],l=t.strides[1],u=e.length,f=t.offset;for(n=s<0?-1:1,a=0;a<u;a++)o=e[a]%s,i=n*(e[a]-o),t.data[f+i+o*l]=r};var $=function(t,e,r,n){var i,o,a,s,l,u,f=t.strides[0],h=t.strides[1],p=e.length,c=t.offset;for(i=f<0?-1:1,u=0;u<p;u++)a=e[u]%f,o=(s=i*(e[u]-a))/f,l=c+s+a*h,t.data[l]=r.call(n,t.data[l],o,a,l)};var D=function(t,e,r){var n,i,o,a,s,l,u,f=t.strides[0],h=t.strides[1],p=r.strides[0],c=r.strides[1],y=e.length,d=t.offset,g=r.offset;if(r.length!==y)throw new Error("invalid input argument. Number of indices does not match the number of elements in the value matrix.");for(n=f<0?-1:1,i=p<0?-1:1,u=0;u<y;u++)s=e[u]%f,o=n*(e[u]-s),a=i*(u-(l=u%p)),t.data[d+o+s*h]=r.data[g+a+l*c]};var q=function(t,e,r,n,i){var o,a,s,l,u=t.strides[0],f=t.strides[1],h=e.length,p=r.length,c=t.offset;for(a=0;a<h;a++)for(o=c+e[a]*u,s=0;s<p;s++)l=o+r[s]*f,t.data[l]=n.call(i,t.data[l],e[a],r[s],l)};var Y=function(t,e,r,n){var i,o,a,s=t.strides[0],l=t.strides[1],u=e.length,f=r.length,h=t.offset;for(o=0;o<u;o++)for(i=h+e[o]*s,a=0;a<f;a++)t.data[i+r[a]*l]=n};var L=function(t,e,r,n){var i,o,a,s,l=t.strides[0],u=t.strides[1],f=n.strides[0],h=n.strides[1],p=e.length,c=r.length,y=t.offset,d=n.offset;if(n.shape[0]!==p||n.shape[1]!==c)throw new Error("invalid input argument. The dimensions given by the row and column indices do not match the value matrix dimensions.");for(a=0;a<p;a++)for(i=y+e[a]*l,o=d+a*f,s=0;s<c;s++)t.data[i+r[s]*u]=n.data[o+s*h]};function G(t,e){var r,n;if(null===t)for(r=new Array(e),n=0;n<e;n++)r[n]=n;else{if(!E(t))throw new TypeError("invalid input argument. Row and column indices must be arrays of nonnegative integers. Value: `"+t+"`.");for(r=[],n=0;n<t.length;n++)t[n]<e&&r.push(t[n])}return r}var X=function(){var t,e,r,n,i=arguments.length;for(t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];if(i<3){if(!E(t[0]))throw new TypeError("invalid input argument. First argument must be an array of nonnegative integers. Value: `"+t[0]+"`.");U(t[1])?$(this,t[0],t[1]):f(t[1])||h(t[1])?R(this,t[0],t[1]):D(this,t[0],t[1])}else if(3===i)if(U(t[1])){if(!E(t[0]))throw new TypeError("invalid input argument. First argument must be an array of nonnegative integers. Value: `"+t[0]+"`.");$(this,t[0],t[1],t[2])}else U(t[2])?(e=G(t[0],this.shape[0]),r=G(t[1],this.shape[1]),q(this,e,r,t[2],this)):f(t[2])?(e=G(t[0],this.shape[0]),r=G(t[1],this.shape[1]),Y(this,e,r,t[2])):(e=G(t[0],this.shape[0]),r=G(t[1],this.shape[1]),L(this,e,r,t[2]));else{if(!U(t[2]))throw new TypeError("invalid input argument. Callback argument must be a function. Value: `"+t[2]+"`.");e=G(t[0],this.shape[0]),r=G(t[1],this.shape[1]),q(this,e,r,t[2],t[3])}return this},B=/^(?:(?:-(?=\d+))?\d*|end(?:-\d+|\/\d+)?):(?:(?:-(?=\d+))?\d*|end(?:-\d+|\/\d+)?)(?:\:(?=-?\d*)(?:-?\d+)?)?$/,Q=/^end/,K=/(-|\/)(?=\d+)(\d+)?$/;var J=function(t,e){var r,n,i,o,a;if(!v(t)||!B.test(t))throw new Error("indexspace()::invalid input argument. Invalid subsequence syntax. Please consult documentation. Value: `"+t+"`.");if(!A(e))throw new TypeError("indexspace()::invalid input argument. Reference array length must be a nonnegative integer. Value: `"+e+"`.");if(!e)return[];if(r=(t=t.split(":"))[0],n=t[1],0===(o=2===t.length?1:parseInt(t[2],10)))throw new Error("indexspace()::invalid syntax. Increment must be an integer not equal to 0. Value: `"+o+"`.");if(Q.test(r))(i=r.match(K))?"-"===i[1]?(r=e-1-parseInt(i[2],10))<0&&(r=0):(r=(e-1)/parseInt(i[2],10),r=Math.ceil(r)):r=e-1;else if((r=parseInt(r,10))!=r)r=o<0?e-1:0;else if(r<0)(r=e+r)<0&&(r=0);else if(r>=e)return[];if(Q.test(n)?(i=n.match(K))?"-"===i[1]?(n=e-1-parseInt(i[2],10))<0&&(n=0):(n=(e-1)/parseInt(i[2],10),n=Math.ceil(n)-1):n=e-1:(n=parseInt(n,10))!=n?n=o<0?0:e-1:n<0?((n=e+n)<0&&(n=0),o>0&&(n-=1)):o<0?n+=1:n>=e?n=e-1:n-=1,a=[],o<0){if(n>r)return a;for(;r>=n;)a.push(r),r+=o}else{if(r>n)return a;for(;r<=n;)a.push(r),r+=o}return a};var W=function(t,e,r){var n,i,o,a,s,l,u,h,p,c,y,d,g,m,w,b,x,A,E;if(!v(t))throw new TypeError("invalid input argument. Must provide a string primitive. Value: `"+t+"`.");if(2!==(l=t.split(",")).length)throw new Error("invalid input argument. Subsequence string must specify row and column subsequences. Value: `"+t+"`.");if(U(e)?o=e:f(e)||(u=e),a=J(l[0],this.shape[0]),s=J(l[1],this.shape[1]),n=a.length,i=s.length,!n||!i)return this;if(p=this.strides[0],c=this.strides[1],g=this.offset,o)for(h=arguments.length>2?r:this,x=0;x<n;x++)for(w=g+a[x]*p,A=0;A<i;A++)E=w+s[A]*c,this.data[E]=o.call(h,this.data[E],a[x],s[A],E);else if(u){if(n!==u.shape[0])throw new Error("invalid input arguments. Row subsequence does not match input matrix dimensions. Expected a ["+n+","+i+"] matrix and instead received a ["+u.shape.join(",")+"] matrix.");if(i!==u.shape[1])throw new Error("invalid input arguments. Column subsequence does not match input matrix dimensions. Expected a ["+n+","+i+"] matrix and instead received a ["+u.shape.join(",")+"] matrix.");for(y=u.strides[0],d=u.strides[1],m=u.offset,x=0;x<n;x++)for(w=g+a[x]*p,b=m+x*y,A=0;A<i;A++)this.data[w+s[A]*c]=u.data[b+A*d]}else for(x=0;x<n;x++)for(w=g+a[x]*p,A=0;A<i;A++)this.data[w+s[A]*c]=e;return this};var H=function(t,e){if(!A(t)||!A(e))throw new TypeError("invalid input argument. Indices must be nonnegative integers. Values: `["+t+","+e+"]`.");return this.data[this.offset+t*this.strides[0]+e*this.strides[1]]};var Z=function(t){var e,r;if(!p(t))throw new TypeError("invalid input argument. Must provide a integer. Value: `"+t+"`.");if(!(t<0&&(t+=this.length)<0))return e=t-(r=t%this.strides[0]),this.strides[0]<0&&(e=-e),this.data[this.offset+e+r*this.strides[1]]},tt={int8:Int8Array,uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array};var et=function(t,e){var r,n,i,o,a,s,l,u,f,h,p,c,y,d,g,m;if(s=this.strides[0],l=this.strides[1],h=this.offset,arguments.length<2){if(!E(t))throw new TypeError("invalid input argument. Linear indices must be specified as a nonnegative integer array. Value: `"+t+"`.");for(y=[],m=0;m<t.length;m++)t[m]<this.length&&y.push(t[m]);for(g=y.length,a=new tt[this.dtype](g),i=new this.constructor(a,this.dtype,[1,g],0,[g,1]),o=s<0?-1:1,m=0;m<g;m++)d=y[m]%s,p=o*(y[m]-d),a[m]=this.data[h+p+d*l]}else{if(r=this.shape[0],null===t)for(y=new Array(r),m=0;m<r;m++)y[m]=m;else{if(!E(t))throw new TypeError("invalid input argument. Row indices must be specified as a nonnegative integer array. Value: `"+t+"`.");for(y=[],m=0;m<t.length;m++)t[m]<r&&y.push(t[m])}if(n=this.shape[1],null===e)for(d=new Array(n),m=0;m<n;m++)d[m]=m;else{if(!E(e))throw new TypeError("invalid input argument. Column indices must be specified as a nonnegative integer array. Value: `"+e+"`.");for(d=[],m=0;m<e.length;m++)e[m]<n&&d.push(e[m])}for(r=y.length,n=d.length,a=new tt[this.dtype](r*n),u=(i=new this.constructor(a,this.dtype,[r,n],0,[n,1])).strides[0],f=i.strides[1],g=0;g<r;g++)for(p=h+y[g]*s,c=g*u,m=0;m<n;m++)a[c+m*f]=this.data[p+d[m]*l]}return i};var rt=function(t){var e,r,n,i,o,a,s,l,u,f,h,p,c,y,d;if(!v(t))throw new TypeError("invalid input argument. Must provide a string primitive. Value: `"+t+"`.");if(2!==(o=t.split(",")).length)throw new Error("invalid input argument. Subsequence string must specify row and column subsequences. Value: `"+t+"`.");if(n=J(o[0],this.shape[0]),i=J(o[1],this.shape[1]),s=(e=n.length)*(r=i.length),h=new tt[this.dtype](s),a=new this.constructor(h,this.dtype,[e,r],0,[r,1]),s)for(l=this.strides[0],u=this.strides[1],f=this.offset,y=0;y<e;y++)for(p=f+n[y]*l,c=y*r,d=0;d<r;d++)h[c+d]=this.data[p+i[d]*u];return a};var nt=function(){var t,e,r,n=this.shape[0],i=this.shape[1],o=this.strides[0],a=this.strides[1],s=n-1,l=i-1,u="";for(e=0;e<n;e++){for(t=this.offset+e*o,r=0;r<i;r++)u+=this.data[t+r*a],r<l&&(u+=",");e<s&&(u+=";")}return u},it=Number.POSITIVE_INFINITY;var ot=function(t){return"object"==typeof t&&null!==t&&(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))},at=Object.prototype.toString;var st=function(t){var e,r,n;return null===t?"null":"object"===(e=typeof t)?(r=t,"Object"!==(n=at.call(r).slice(8,-1))&&"Error"!==n||!r.constructor?n:function(t){if(t.name)return t.name;var e=/^\s*function\s*([^\(]*)/im.exec(t.toString());return e?e[1]:""}(r.constructor)):e},lt=/^\/((?:\\\/|[^\/])+)\/([imgy]*)$/;var ut,ft=function(t){if(!v(t))throw new TypeError("invalid input argument. Must provide a regular expression string. Value: `"+t+"`.");return(t=lt.exec(t))?new RegExp(t[1],t[2]):null},ht=Object.prototype.toString,pt=function(t){var e=ht.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===ht.call(t.callee)),r};if(!Object.keys){var ct=Object.prototype.hasOwnProperty,yt=Object.prototype.toString,dt=pt,gt=Object.prototype.propertyIsEnumerable,mt=!gt.call({toString:null},"toString"),vt=gt.call((function(){}),"prototype"),wt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],bt=function(t){var e=t.constructor;return e&&e.prototype===t},xt={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},At=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!xt["$"+t]&&ct.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{bt(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();ut=function(t){var e=null!==t&&"object"==typeof t,r="[object Function]"===yt.call(t),n=dt(t),i=e&&"[object String]"===yt.call(t),o=[];if(!e&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var a=vt&&r;if(i&&t.length>0&&!ct.call(t,0))for(var s=0;s<t.length;++s)o.push(String(s));if(n&&t.length>0)for(var l=0;l<t.length;++l)o.push(String(l));else for(var u in t)a&&"prototype"===u||!ct.call(t,u)||o.push(String(u));if(mt)for(var f=function(t){if("undefined"==typeof window||!At)return bt(t);try{return bt(t)}catch(t){return!1}}(t),h=0;h<wt.length;++h)f&&"constructor"===wt[h]||!ct.call(t,wt[h])||o.push(wt[h]);return o}}var Et=ut,Ot=Array.prototype.slice,Mt=Object.keys,It=Mt?function(t){return Mt(t)}:Et,jt=Object.keys;It.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return pt(t)?jt(Ot.call(t)):jt(t)}):Object.keys=It;return Object.keys||It};var Tt=It,Nt=Tt.shim();var _t=function(t){var e,r,n,i,o;if(!(t instanceof Error))throw new TypeError("invalid input argument. Must provide an error object. Value: `"+t+"`.");for(i=new t.constructor(t.message),t.stack&&(i.stack=t.stack),t.code&&(i.code=t.code),t.errno&&(i.errno=t.errno),t.syscall&&(i.syscall=t.syscall),e=Nt(t),o=0;o<e.length;o++)n=e[o],(r=Object.getOwnPropertyDescriptor(t,n)).hasOwnProperty("value")&&(r.value=zt(t[n])),Object.defineProperty(i,n,r);return i};var Pt=function(t,e,r){var n,i;if(!c(t))throw new TypeError("invalid input argument. First argument must be an array-like object. Value: `"+t+"`.");if(0===(n=t.length))return-1;if(3===arguments.length){if(!p(r))throw new TypeError("invalid input argument. `fromIndex` must be an integer. Value: `"+r+"`.");if(r>=0){if(r>=n)return-1;i=r}else(i=n+r)<0&&(i=0)}else i=0;if(e!=e){for(;i<n;i++)if(t[i]!=t[i])return i}else for(;i<n;i++)if(t[i]===e)return i;return-1},St={Int8Array:null,Uint8Array:null,Uint8ClampedArray:null,Int16Array:null,Uint16Array:null,Int32Array:null,Uint32Array:null,Float32Array:null,Float64Array:null};!function(){var t,e,r=Tt(St),n=r.length;for(e=0;e<n;e++)t=r[e],St[t]=new Function("arr","return new "+t+"( arr );")}();var Ft=St;function Vt(t,e,r,n,i){var o,a,s,l,u,f,h,p,c,y;if(i-=1,"object"!=typeof t||null===t)return t;if(ot(t))return new Buffer(t);if(t instanceof Error)return _t(t);if("Date"===(s=st(t)))return new Date(+t);if("RegExp"===s)return ft(t.toString());if("Set"===s)return new Set(t);if("Map"===s)return new Map(t);if("String"===s||"Boolean"===s||"Number"===s)return t.valueOf();if(u=Ft[s])return u(t);if("Array"!==s&&"Object"!==s)return"function"==typeof Object.freeze?function(t){var e,r,n,i,o,a,s=[],l=[];for(o=Object.create(Object.getPrototypeOf(t)),s.push(t),l.push(o),e=Object.getOwnPropertyNames(t),a=0;a<e.length;a++)r=e[a],(n=Object.getOwnPropertyDescriptor(t,r)).hasOwnProperty("value")&&(i=w(t[r])?[]:{},n.value=Vt(t[r],i,s,l,-1)),Object.defineProperty(o,r,n);return Object.isExtensible(t)||Object.preventExtensions(o),Object.isSealed(t)&&Object.seal(o),Object.isFrozen(t)&&Object.freeze(o),o}(t):{};if(a=Tt(t),i>0)for(o=s,y=0;y<a.length;y++)p=t[f=a[y]],s=st(p),"object"!=typeof p||null===p||"Array"!==s&&"Object"!==s||ot(p)?"Object"===o?((l=Object.getOwnPropertyDescriptor(t,f)).hasOwnProperty("value")&&(l.value=Vt(p)),Object.defineProperty(e,f,l)):e[f]=Vt(p):-1===(c=Pt(r,p))?(h=w(p)?[]:{},r.push(p),n.push(h),"Array"===o?e[f]=Vt(p,h,r,n,i):((l=Object.getOwnPropertyDescriptor(t,f)).hasOwnProperty("value")&&(l.value=Vt(p,h,r,n,i)),Object.defineProperty(e,f,l))):e[f]=n[c];else if("Array"===s)for(y=0;y<a.length;y++)e[f=a[y]]=t[f];else for(y=0;y<a.length;y++)f=a[y],l=Object.getOwnPropertyDescriptor(t,f),Object.defineProperty(e,f,l);return Object.isExtensible(t)||Object.preventExtensions(e),Object.isSealed(t)&&Object.seal(e),Object.isFrozen(t)&&Object.freeze(e),e}var kt=Vt;var zt=function(t,e){var r;if(arguments.length>1){if(!A(e))throw new TypeError("invalid input argument. Level must be a nonnegative integer. Value: `"+e+"`.");if(0===e)return t}else e=it;return r=w(t)?[]:{},kt(t,r,[t],[r],e)};var Ct=function(){var t,e;return(e={}).type="Matrix",e.dtype=this.dtype,e.shape=zt(this.shape),e.offset=this.offset,e.strides=zt(this.strides),t=Object.getOwnPropertyDescriptor(this,"data"),e.raw=t.writable&&t.configurable&&t.enumerable,e.data=S(this.data,"generic"),e};function Ut(t,e,r,n,i){return this instanceof Ut?(Object.defineProperty(this,"dtype",{value:e,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"shape",{value:r,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"strides",{value:i,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"offset",{value:n,configurable:!1,enumerable:!0,writable:!0}),Object.defineProperty(this,"ndims",{value:r.length,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"length",{value:t.length,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"nbytes",{value:t.byteLength,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"data",{value:t,configurable:!1,enumerable:!0,writable:!1}),this):new Ut(t,e,r,n,i)}Ut.prototype.set=z,Ut.prototype.iset=C,Ut.prototype.mset=X,Ut.prototype.sset=W,Ut.prototype.get=H,Ut.prototype.iget=Z,Ut.prototype.mget=et,Ut.prototype.sget=rt,Ut.prototype.toString=nt,Ut.prototype.toJSON=Ct;var Rt=Ut,$t=["int8","uint8","uint8_clamped","int16","uint16","int32","uint32","float32","float64"];var Dt=function(){var t,e,r,n,i,o,a,s;if(1===arguments.length?(r=arguments[0],i=2):2===arguments.length?v(arguments[1])?(r=arguments[0],t=arguments[1],i=23):(n=arguments[0],r=arguments[1],i=12):(n=arguments[0],r=arguments[1],t=arguments[2],i=123),!E(r))throw new TypeError("invalid input argument. A matrix shape must be an array of nonnegative integers. Value: `"+r+"`.");if(2!==(e=r.length))throw new Error("invalid input argument. Shape must be a 2-element array. Value: `"+r+"`.");if(123===i||23===i){if(!M($t,t))throw new TypeError("invalid input argument. Unrecognized/unsupported data type. Value: `"+t+"`.")}else t="float64";for(o=1,s=0;s<e;s++)o*=r[s];if(123===i||12===i){if(a=k(n),!M($t,a)&&!w(n))throw new TypeError("invalid input argument. Input data must be a valid type. Consult the documentation for a list of valid data types. Value: `"+n+"`.");if(o!==n.length)throw new Error("invalid input argument. Matrix shape does not match the input data length.");123===i&&a!==t||"generic"===a?n=S(n,t):t=a}else n=new tt[t](o);return new Rt(n,t,r,0,[r[1],1])};var qt=function(t,e,r){return(t=this.offset+t*this.strides[0]+e*this.strides[1])>=0&&(this.data[t]=r),this};var Yt=function(t,e){var r,n;return t<0&&(t+=this.length)<0||(r=t-(n=t%this.strides[0]),this.strides[0]<0&&(r=-r),this.data[this.offset+r+n*this.strides[1]]=e),this};function Lt(t,e){var r,n;if(null===t)for(r=new Array(e),n=0;n<e;n++)r[n]=n;else r=t;return r}var Gt=function(){var t,e,r,n,i=arguments.length;for(t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];return i<3?"function"==typeof t[1]?$(this,t[0],t[1]):"number"==typeof t[1]?R(this,t[0],t[1]):D(this,t[0],t[1]):3===i?"function"==typeof t[1]?$(this,t[0],t[1],t[2]):"function"==typeof t[2]?(e=Lt(t[0],this.shape[0]),r=Lt(t[1],this.shape[1]),q(this,e,r,t[2],this)):"number"==typeof t[2]?(e=Lt(t[0],this.shape[0]),r=Lt(t[1],this.shape[1]),Y(this,e,r,t[2])):(e=Lt(t[0],this.shape[0]),r=Lt(t[1],this.shape[1]),L(this,e,r,t[2])):(e=Lt(t[0],this.shape[0]),r=Lt(t[1],this.shape[1]),q(this,e,r,t[2],t[3])),this};var Xt=function(t,e,r){var n,i,o,a,s,l,u,f,h,p,c,y,d,g,m,v,w,b,x;if(l=t.split(","),"function"==typeof e?o=e:"number"!=typeof e&&(u=e),a=J(l[0],this.shape[0]),s=J(l[1],this.shape[1]),n=a.length,i=s.length,!n||!i)return this;if(h=this.strides[0],p=this.strides[1],d=this.offset,o)for(f=arguments.length>2?r:this,w=0;w<n;w++)for(m=d+a[w]*h,b=0;b<i;b++)x=m+s[b]*p,this.data[x]=o.call(f,this.data[x],a[w],s[b],x);else if(u){if(n!==u.shape[0])throw new Error("invalid input arguments. Row subsequence does not match input matrix dimensions. Expected a ["+n+","+i+"] matrix and instead received a ["+u.shape.join(",")+"] matrix.");if(i!==u.shape[1])throw new Error("invalid input arguments. Column subsequence does not match input matrix dimensions. Expected a ["+n+","+i+"] matrix and instead received a ["+u.shape.join(",")+"] matrix.");for(c=u.strides[0],y=u.strides[1],g=u.offset,w=0;w<n;w++)for(m=d+a[w]*h,v=g+w*c,b=0;b<i;b++)this.data[m+s[b]*p]=u.data[v+b*y]}else for(w=0;w<n;w++)for(m=d+a[w]*h,b=0;b<i;b++)this.data[m+s[b]*p]=e;return this};var Bt=function(t,e){return this.data[this.offset+t*this.strides[0]+e*this.strides[1]]};var Qt=function(t){var e,r;if(!(t<0&&(t+=this.length)<0))return e=t-(r=t%this.strides[0]),this.strides[0]<0&&(e=-e),this.data[this.offset+e+r*this.strides[1]]};var Kt=function(t,e){var r,n,i,o,a,s,l,u,f,h,p,c,y,d,g,m;if(s=this.strides[0],l=this.strides[1],h=this.offset,arguments.length<2)for(g=(y=t).length,a=new tt[this.dtype](g),i=new this.constructor(a,this.dtype,[1,g],0,[g,1]),o=s<0?-1:1,m=0;m<g;m++)d=y[m]%s,p=o*(y[m]-d),a[m]=this.data[h+p+d*l];else{if(null===t)for(r=this.shape[0],y=new Array(r),m=0;m<r;m++)y[m]=m;else r=t.length,y=t;if(null===e)for(n=this.shape[1],d=new Array(n),m=0;m<n;m++)d[m]=m;else n=e.length,d=e;for(a=new tt[this.dtype](r*n),u=(i=new this.constructor(a,this.dtype,[r,n],0,[n,1])).strides[0],f=i.strides[1],g=0;g<r;g++)for(p=h+y[g]*s,c=g*u,m=0;m<n;m++)a[c+m*f]=this.data[p+d[m]*l]}return i};var Jt=function(t){var e,r,n,i,o,a,s,l,u,f,h,p,c,y,d;if(o=t.split(","),n=J(o[0],this.shape[0]),i=J(o[1],this.shape[1]),s=(e=n.length)*(r=i.length),h=new tt[this.dtype](s),a=new this.constructor(h,this.dtype,[e,r],0,[r,1]),s)for(l=this.strides[0],u=this.strides[1],f=this.offset,y=0;y<e;y++)for(p=f+n[y]*l,c=y*r,d=0;d<r;d++)h[c+d]=this.data[p+i[d]*u];return a};function Wt(t,e,r,n,i){return this instanceof Wt?(this.dtype=e,this.shape=r,this.strides=i,this.offset=n,this.ndims=r.length,this.length=t.length,this.nbytes=t.byteLength,this.data=t,this):new Wt(t,e,r,n,i)}Wt.prototype.set=qt,Wt.prototype.iset=Yt,Wt.prototype.mset=Gt,Wt.prototype.sset=Xt,Wt.prototype.get=Bt,Wt.prototype.iget=Qt,Wt.prototype.mget=Kt,Wt.prototype.sget=Jt,Wt.prototype.toString=nt,Wt.prototype.toJSON=Ct;var Ht=Wt;var Zt=Dt,te=function(){var t,e,r,n,i,o;if(1===arguments.length?r=arguments[0]:2===arguments.length?v(arguments[1])?(r=arguments[0],t=arguments[1]):(n=arguments[0],r=arguments[1]):(n=arguments[0],r=arguments[1],t=arguments[2]),2!==(e=r.length))throw new Error("invalid input argument. Shape must be a 2-element array. Value: `"+r+"`.");for(i=1,o=0;o<e;o++)i*=r[o];if(n){if(!t&&(t=k(n),!M($t,t)))throw new TypeError("invalid input argument. Input data must be a valid type. Consult the documentation for a list of valid data types. Value: `"+n+"`.");if(i!==n.length)throw new Error("invalid input argument. Matrix shape does not match the input data length.")}else t||(t="float64"),n=new tt[t](i);return new Ht(n,t,r,0,[r[1],1])};Zt.raw=te;var ee=function(t){return"object"==typeof t&&null!==t&&!w(t)};var re=function(t){return!0===t||!1===t};var ne=function(t,e){return ee(e)?e.hasOwnProperty("copy")&&(t.copy=e.copy,!re(t.copy))?new TypeError("erfcinv()::invalid option. Copy option must be a boolean primitive. Option: `"+t.copy+"`."):e.hasOwnProperty("accessor")&&(t.accessor=e.accessor,!U(t.accessor))?new TypeError("erfcinv()::invalid option. Accessor must be a function. Option: `"+t.accessor+"`."):e.hasOwnProperty("path")&&(t.path=e.path,!v(t.path))?new TypeError("erfcinv()::invalid option. Key path option must be a string primitive. Option: `"+t.path+"`."):e.hasOwnProperty("sep")&&(t.sep=e.sep,!v(t.sep))?new TypeError("erfcinv()::invalid option. Separator option must be a string primitive. Option: `"+t.sep+"`."):e.hasOwnProperty("dtype")&&(t.dtype=e.dtype,!v(t.dtype))?new TypeError("erfcinv()::invalid option. Data type option must be a string primitive. Option: `"+t.dtype+"`."):null:new TypeError("erfcinv()::invalid input argument. Options argument must be an object. Value: `"+e+"`.")};var ie=function(t){var e,r;if(!w(t))return!1;if(!(e=t.length))return!1;for(var n=0;n<e;n++)if("number"!=typeof(r=t[n])||r!=r)return!1;return!0};function oe(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n=n*e+t[i];return n}var ae=function(t,e,r){var n,i,o,a,s,l=!0;if(!ie(t))throw new TypeError("polynomial()::invalid input argument. Coefficients must be provided as an array of number primitives. Value: `"+t+"`.");if(f(e))return oe(t,e);if(!w(e))throw new TypeError("polynomial()::invalid input argument. Second argument must be either a single number primitive or an array of values. Value: `"+e+"`.");if(arguments.length>2){if(!ee(r))throw new TypeError("polynomial()::invalid input argument. Options argument must be an object. Value: `"+r+"`.");if(r.hasOwnProperty("copy")&&(l=r.copy,!re(l)))throw new TypeError("polynomial()::invalid option. Copy option must be a boolean primitive. Option: `"+l+"`.");if(r.hasOwnProperty("accessor")&&(n=r.accessor,!U(n)))throw new TypeError("polynomial()::invalid option. Accessor must be a function. Option: `"+n+"`.")}if(i=e.length,o=l?new Array(i):e,n)for(s=0;s<i;s++){if(a=n(e[s],s),!f(a))throw new TypeError("polynomial()::invalid input argument. Accessed array values must be number primitives. Value: `"+a+"`.");o[s]=oe(t,a)}else for(s=0;s<i;s++){if(a=e[s],!f(a))throw new TypeError("polynomial()::invalid input argument. Array values must be number primitives. Value: `"+a+"`.");o[s]=oe(t,a)}return o},se=[-.005387729650712429,.008226878746769157,.02198786811111689,-.03656379714117627,-.012692614766297404,.03348066254097446,-.008368748197417368,-.0005087819496582806],le=[.0008862163904564247,-.0023339375937419,.07952836873415717,-.05273963823400997,-.7122890234154284,.662328840472003,1.5622155839842302,-1.5657455823417585,-.9700050433032906,1],ue=[-3.6719225470772936,21.12946554483405,17.445385985570866,-44.6382324441787,-18.851064805871424,17.644729840837403,8.3705032834312,.10526468069939171,-.20243350835593876],fe=[1.7211476576120028,-22.643693341313973,10.826866735546016,48.560921310873994,-20.14326346804852,-28.66081804998,3.971343795334387,6.242641248542475,1],he=[-6.81149956853777e-10,2.8522533178221704e-8,-6.794655751811263e-7,.0021455899538880526,.029015791000532906,.14286953440815717,.3377855389120359,.38707973897260434,.11703015634199525,-.16379404719331705,-.1311027816799519],pe=[.011059242293464892,.15226433829533179,.848854343457902,2.5930192162362027,4.778465929458438,5.381683457070069,3.4662540724256723,1],ce=[26633922742578204e-28,-2.304047769118826e-10,460469890584318e-20,.00015754461742496055,.0018712349281955923,.009508047013259196,.018557330651423107,-.0022242652921344794,-.0350353787183178],ye=[7646752923027944e-20,.00263861676657016,.03415891436709477,.22009110576413124,.7620591645536234,1.3653349817554064,1],de=[9905570997331033e-32,-2811287356288318e-29,4.625961635228786e-9,4.4969678992770644e-7,14962478375834237e-21,.00020938631748758808,.001056288621524929,-.0011295143874558028,-.016743100507663373],ge=[2.82243172016108e-7,27533547476472603e-21,.0009640118070051656,.016074608709367652,.1381518657490833,.5914293448864175,1];function me(t,e,r,n,i){var o;return i*t+ae(r,o=t-e)/ae(n,o)*t}var ve=function(t){var e,r,n,i=!1;if(t!=t)return NaN;if(t<0||t>2)throw new RangeError("erfcinv()::invalid input argument. Value must be on the interval [0,2]. Value: `"+t+"`.");return 0===t?Number.POSITIVE_INFINITY:2===t?Number.NEGATIVE_INFINITY:1===t?0:(t>1?(t=1-(r=2-t),i=!0):(r=t,t=1-t),t<=.5?(e=.08913147449493408*(n=t*(t+10))+n*(ae(se,t)/ae(le,t)),i?-e:e):r>=.25?(e=(n=Math.sqrt(-2*Math.log(r)))/(2.249481201171875+ae(ue,r-=.25)/ae(fe,r)),i?-e:e):(r=Math.sqrt(-Math.log(r)))<3?me(r,1.125,he,pe,.807220458984375):r<6?me(r,3,ce,ye,.9399557113647461):me(r,6,de,ge,.9836282730102539))};var we=function(t,e){var r,n=e.length;for(r=0;r<n;r++)"number"==typeof e[r]?t[r]=ve(e[r]):t[r]=NaN;return t};var be=function(t,e,r){var n,i,o=e.length;for(i=0;i<o;i++)n=r(e[i],i),t[i]="number"==typeof n?ve(n):NaN;return t};var xe=function(t,e){return ee(e)?e.hasOwnProperty("create")&&(t.create=e.create,!re(t.create))?new TypeError("deepSet()::invalid option. Create option must be a boolean primitive. Option: `"+t.create+"`."):e.hasOwnProperty("sep")&&(t.sep=e.sep,!v(t.sep))?new TypeError("deepSet()::invalid option. Key path separator must be a string primitive. Option: `"+t.sep+"`."):null:new TypeError("deepSet()::invalid input argument. Options argument must be an object. Value: `"+e+"`.")};var Ae=function(){return{create:!1,sep:"."}};var Ee=function(t,e,r,n){var i,o,a=e.length,s=!1,l=t;for(o=0;o<a&&(i=e[o],"object"==typeof l&&null!==l);o++){if(!l.hasOwnProperty(i)){if(!r)break;l[i]={}}o===a-1?(l[i]="function"==typeof n?n(l[i]):n,s=!0):l=l[i]}return s};var Oe=function(t,e,r,n){var i,o,a,s=v(e);if("object"!=typeof t||null===t)return!1;if(!s&&!w(e))throw new TypeError("deepSet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+e+"`.");if(o=Ae(),arguments.length>3&&(a=xe(o,n)))throw a;return i=s?e.split(o.sep):e,Ee(t,i,o.create,r)},Me=function(t,e){var r,n,i,o=v(t);if(!o&&!w(t))throw new TypeError("deepSet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+t+"`.");if(n=Ae(),arguments.length>1&&(i=xe(n,e)))throw i;return r=o?t.split(n.sep):t,function(t,e){return"object"==typeof t&&null!==t&&Ee(t,r,n.create,e)}};Oe.factory=Me;var Ie=function(t,e){return ee(e)?e.hasOwnProperty("sep")&&(t.sep=e.sep,!v(t.sep))?new TypeError("deepGet()::invalid option. Key path separator must be a string primitive. Option: `"+t.sep+"`."):null:new TypeError("deepGet()::invalid input argument. Options argument must be an object. Value: `"+e+"`.")};var je=function(){return{sep:"."}};var Te=function(t,e){var r,n=e.length,i=t;for(r=0;r<n;r++){if("object"!=typeof i||null===i||!i.hasOwnProperty(e[r]))return;i=i[e[r]]}return i};var Ne=function(t,e,r){var n,i,o,a=v(e);if("object"==typeof t&&null!==t){if(!a&&!w(e))throw new TypeError("deepGet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+e+"`.");if(i=je(),arguments.length>2&&(o=Ie(i,r)))throw o;return n=a?e.split(i.sep):e,Te(t,n)}},_e=function(t,e){var r,n,i,o=v(t);if(!o&&!w(t))throw new TypeError("deepGet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+t+"`.");if(n=je(),arguments.length>1&&(i=Ie(n,e)))throw i;return r=o?t.split(n.sep):t,function(t){if("object"==typeof t&&null!==t)return Te(t,r)}};Ne.factory=_e;var Pe=Oe.factory,Se=Ne.factory;var Fe=function(t,e,r){var n,i,o,a,s=t.length,l={};if(arguments.length>2&&(l.sep=r),s)for(n=Se(e,l),i=Pe(e,l),a=0;a<s;a++)o=n(t[a]),i(t[a],"number"==typeof o?ve(o):NaN);return t};var Ve=function(t,e){var r,n=e.length;if(t.length!==n)throw new Error("erfcinv()::invalid input arguments. Input and output matrices must be the same length.");for(r=0;r<n;r++)t.data[r]=ve(e.data[r]);return t};var ke=function(t,e){var r,n=e.length;for(r=0;r<n;r++)t[r]=ve(e[r]);return t};var ze=function(t,e){var r,n,i,o,a,s={};if(f(t)||h(t))return ve(t);if(arguments.length>1&&(n=ne(s,e)))throw n;if(d(t)){if(!1!==s.copy){if(o=s.dtype||"float64",null===(r=m(o)))throw new Error("erfcinv()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+o+"`.");a=new r(t.length),i=Zt(a,t.shape,o)}else i=t;return Ve(i,t)}if(y(t)){if(!1===s.copy)i=t;else{if(o=s.dtype||"float64",null===(r=m(o)))throw new Error("erfcinv()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+o+"`.");i=new r(t.length)}return ke(i,t)}if(c(t)){if(s.path)return s.sep=s.sep||".",Fe(t,s.path,s.sep);if(!1===s.copy)i=t;else if(s.dtype){if(null===(r=m(s.dtype)))throw new TypeError("erfcinv()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+s.dtype+"`.");i=new r(t.length)}else i=new Array(t.length);return s.accessor?be(i,t,s.accessor):we(i,t)}return NaN};var Ce=function(t){return f(t)&&t>0};var Ue=function(t,e){return ee(e)?e.hasOwnProperty("sigma")&&(t.sigma=e.sigma,!Ce(t.sigma))?new TypeError("cdf()::invalid option. `sigma` parameter must be a positive number. Option: `"+t.sigma+"`."):e.hasOwnProperty("copy")&&(t.copy=e.copy,!re(t.copy))?new TypeError("cdf()::invalid option. Copy option must be a boolean primitive. Option: `"+t.copy+"`."):e.hasOwnProperty("accessor")&&(t.accessor=e.accessor,!U(t.accessor))?new TypeError("cdf()::invalid option. Accessor must be a function. Option: `"+t.accessor+"`."):e.hasOwnProperty("path")&&(t.path=e.path,!v(t.path))?new TypeError("cdf()::invalid option. Key path option must be a string primitive. Option: `"+t.path+"`."):e.hasOwnProperty("sep")&&(t.sep=e.sep,!v(t.sep))?new TypeError("cdf()::invalid option. Separator option must be a string primitive. Option: `"+t.sep+"`."):e.hasOwnProperty("dtype")&&(t.dtype=e.dtype,!v(t.dtype))?new TypeError("cdf()::invalid option. Data type option must be a string primitive. Option: `"+t.dtype+"`."):null:new TypeError("cdf()::invalid input argument. Options argument must be an object. Value: `"+e+"`.")},Re=Math.expm1||function(t){return Math.exp(t)-1},$e=Math.pow;var De=function(t,e){if(t<0)return 0;var r=$e(e,2);return-Re(-$e(t,2)/(2*r))},qe=Math.expm1||function(t){return Math.exp(t)-1},Ye=Math.pow;var Le=function(t){var e=Ye(t,2);return function(t){return t<0?0:-qe(-Ye(t,2)/(2*e))}};var Ge=function(t,e,r){var n,i,o=e.length;for(n=Le(r),i=0;i<o;i++)"number"==typeof e[i]?t[i]=n(e[i]):t[i]=NaN;return t};var Xe=function(t,e,r,n){var i,o,a,s=e.length;for(i=Le(r),a=0;a<s;a++)o=n(e[a],a),t[a]="number"==typeof o?i(o):NaN;return t},Be=Oe.factory,Qe=Ne.factory;var Ke=function(t,e,r,n){var i,o,a,s,l,u=t.length,f={};if(arguments.length>3&&(f.sep=n),u)for(i=Qe(r,f),o=Be(r,f),a=Le(e),l=0;l<u;l++)s=i(t[l]),o(t[l],"number"==typeof s?a(s):NaN);return t};var Je=function(t,e,r){var n,i,o=e.length;if(t.length!==o)throw new Error("cdf()::invalid input arguments. Input and output matrices must be the same length.");for(n=Le(r),i=0;i<o;i++)t.data[i]=n(e.data[i]);return t};var We=function(t,e,r){var n,i,o=e.length;for(n=Le(r),i=0;i<o;i++)t[i]=n(e[i]);return t};var He=function(t,e){var r,n,i,o,a,s={};if(arguments.length>1&&(n=Ue(s,e)))throw n;if(s.sigma=void 0!==s.sigma?s.sigma:1,f(t))return De(t,s.sigma);if(d(t)){if(!1!==s.copy){if(o=s.dtype||"float64",null===(r=m(o)))throw new Error("cdf()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+o+"`.");a=new r(t.length),i=Zt(a,t.shape,o)}else i=t;return Je(i,t,s.sigma)}if(y(t)){if(!1===s.copy)i=t;else{if(o=s.dtype||"float64",null===(r=m(o)))throw new Error("cdf()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+o+"`.");i=new r(t.length)}return We(i,t,s.sigma)}if(c(t)){if(s.path)return s.sep=s.sep||".",Ke(t,s.sigma,s.path,s.sep);if(!1===s.copy)i=t;else if(s.dtype){if(null===(r=m(s.dtype)))throw new TypeError("cdf()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+s.dtype+"`.");i=new r(t.length)}else i=new Array(t.length);return s.accessor?Xe(i,t,s.sigma,s.accessor):Ge(i,t,s.sigma)}return NaN},Ze=n((function(t,e){!function(t){function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function r(t){var r;return 1===t.length&&(r=t,t=function(t,n){return e(r(t),n)}),{left:function(e,r,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){var o=n+i>>>1;t(e[o],r)<0?n=o+1:i=o}return n},right:function(e,r,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){var o=n+i>>>1;t(e[o],r)>0?i=o:n=o+1}return n}}}var n=r(e),i=n.right,o=n.left;function a(t){return null===t?NaN:+t}function s(t,e){var r,n,i=t.length,o=0,s=0,l=-1,u=0;if(null==e)for(;++l<i;)isNaN(r=a(t[l]))||(s+=(n=r-o)*(r-(o+=n/++u)));else for(;++l<i;)isNaN(r=a(e(t[l],l,t)))||(s+=(n=r-o)*(r-(o+=n/++u)));if(u>1)return s/(u-1)}function l(t,e){var r=s(t,e);return r?Math.sqrt(r):r}function u(t,e){var r,n,i,o=-1,a=t.length;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n){r=i=n;break}for(;++o<a;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else{for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n){r=i=n;break}for(;++o<a;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n))}return[r,i]}function f(t){return function(){return t}}function h(t){return t}function p(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((e-t)/r)),o=new Array(i);++n<i;)o[n]=t+n*r;return o}var c=Math.sqrt(50),y=Math.sqrt(10),d=Math.sqrt(2);function g(t,e,r){var n=m(t,e,r);return p(Math.ceil(t/n)*n,Math.floor(e/n)*n+n/2,n)}function m(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/i;return o>=c?i*=10:o>=y?i*=5:o>=d&&(i*=2),e<t?-i:i}function v(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function w(t){return+t}function b(t,e,r){if(null==r&&(r=a),n=t.length){if((e=+e)<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,o=Math.floor(i),s=+r(t[o],o,t);return s+(+r(t[o+1],o+1,t)-s)*(i-o)}}function x(t,e){var r,n,i=-1,o=t.length;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n){r=n;break}for(;++i<o;)null!=(n=t[i])&&r>n&&(r=n)}else{for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n){r=n;break}for(;++i<o;)null!=(n=e(t[i],i,t))&&r>n&&(r=n)}return r}function A(t){if(!(i=t.length))return[];for(var e=-1,r=x(t,E),n=new Array(r);++e<r;)for(var i,o=-1,a=n[e]=new Array(i);++o<i;)a[o]=t[o][e];return n}function E(t){return t.length}t.version="0.7.1",t.bisect=i,t.bisectRight=i,t.bisectLeft=o,t.ascending=e,t.bisector=r,t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=l,t.extent=u,t.histogram=function(){var t=h,e=u,r=v;function n(n){var o,a,s=n.length,l=new Array(s);for(o=0;o<s;++o)l[o]=+t(n[o],o,n);var u=e(l),f=+u[0],h=+u[1],p=r(l,f,h);Array.isArray(p)||(p=g(f,h,+p));var c=p.length;for(o=0;o<c;++o)p[o]=+p[o];for(;p[0]<=f;)p.shift(),--c;for(;p[c-1]>=h;)p.pop(),--c;var y,d=new Array(c+1);for(o=0;o<=c;++o)(y=d[o]=[]).x0=o>0?p[o-1]:f,y.x1=o<c?p[o]:h;for(o=0;o<s;++o)f<=(a=l[o])&&a<=h&&d[i(p,a,0,c)].push(n[o]);return d}return n.value=function(e){return arguments.length?(t="function"==typeof e?e:f(+e),n):t},n.domain=function(t){return arguments.length?(e="function"==typeof t?t:f([+t[0],+t[1]]),n):e},n.thresholds=function(t){return arguments.length?(r="function"==typeof t?t:Array.isArray(t)?f(Array.prototype.map.call(t,w)):f(+t),n):r},n},t.thresholdFreedmanDiaconis=function(t,r,n){return t.sort(e),Math.ceil((n-r)/(2*(b(t,.75)-b(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,r){return Math.ceil((r-e)/(3.5*l(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=v,t.max=function(t,e){var r,n,i=-1,o=t.length;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n){r=n;break}for(;++i<o;)null!=(n=t[i])&&n>r&&(r=n)}else{for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n){r=n;break}for(;++i<o;)null!=(n=e(t[i],i,t))&&n>r&&(r=n)}return r},t.mean=function(t,e){var r,n=0,i=t.length,o=-1,s=i;if(null==e)for(;++o<i;)isNaN(r=a(t[o]))?--s:n+=r;else for(;++o<i;)isNaN(r=a(e(t[o],o,t)))?--s:n+=r;if(s)return n/s},t.median=function(t,r){var n,i=[],o=t.length,s=-1;if(null==r)for(;++s<o;)isNaN(n=a(t[s]))||i.push(n);else for(;++s<o;)isNaN(n=a(r(t[s],s,t)))||i.push(n);return b(i.sort(e),.5)},t.merge=function(t){for(var e,r,n,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(r=new Array(a);--i>=0;)for(e=(n=t[i]).length;--e>=0;)r[--a]=n[e];return r},t.min=x,t.pairs=function(t){for(var e=0,r=t.length-1,n=t[0],i=new Array(r<0?0:r);e<r;)i[e]=[n,n=t[++e]];return i},t.permute=function(t,e){for(var r=e.length,n=new Array(r);r--;)n[r]=t[e[r]];return n},t.quantile=b,t.range=p,t.scan=function(t,r){if(n=t.length){var n,i,o=0,a=0,s=t[a];for(r||(r=e);++o<n;)(r(i=t[o],s)<0||0!==r(s,s))&&(s=i,a=o);return 0===r(s,s)?a:void 0}},t.shuffle=function(t,e,r){for(var n,i,o=(null==r?t.length:r)-(e=null==e?0:+e);o;)i=Math.random()*o--|0,n=t[o+e],t[o+e]=t[i+e],t[i+e]=n;return t},t.sum=function(t,e){var r,n=0,i=t.length,o=-1;if(null==e)for(;++o<i;)(r=+t[o])&&(n+=r);else for(;++o<i;)(r=+e(t[o],o,t))&&(n+=r);return n},t.ticks=g,t.tickStep=m,t.transpose=A,t.variance=s,t.zip=function(){return A(arguments)}}(e)}));const{bisectRight:tr}=Ze;var er=class{constructor(t,e,r=1){const n=t.map((t,e)=>e);n.sort((e,r)=>t[e]-t[r]);const i=n.map(e=>t[e]),o=n.map(t=>e[t]),a=n.length,s=n.map(()=>1);this.n=a,this.x=i,this.y=o,this.params=((t,e,r,n)=>{const i=t.length-1,o=new Array(i+1),a=new Array(i+1),s=new Array(i+1),l=new Array(i+1),u=new Array(i+1),f=new Array(i+1),h=new Array(i+1),p=new Array(i+1),c=t.map(()=>[0,0,0,0]);c.pop();const y=2*(1-n)/(3*n);for(let e=0;e<i;++e)o[e]=t[e+1]-t[e],a[e]=3/o[e];u[0]=0;for(let r=1;r<i;++r)s[r]=-(a[r-1]+a[r]),l[r]=2*(t[r+1]-t[r-1]),u[r]=3*(e[r+1]-e[r])/o[r]-3*(e[r]-e[r-1])/o[r-1];u[i]=0;for(let t=1;t<i;++t)f[t]=a[t-1]*a[t-1]*r[t-1]+s[t]*s[t]*r[t]+a[t]*a[t]*r[t+1],f[t]=y*f[t]+l[t];for(let t=1;t<i-1;++t)h[t]=s[t]*a[t]*r[t]+a[t]*s[t+1]*r[t+1],h[t]=y*h[t]+o[t];for(let t=1;t<i-2;++t)p[t]=y*a[t]*a[t+1]*r[t+1];((t,e,r,n)=>{const i=t.length-1;t[0]=0,e[0]=0,r[0]=0,e[1]=e[1]/t[1],r[1]=r[1]/t[1];for(let n=2;n<i;++n)t[n]=t[n]-t[n-2]*r[n-2]*r[n-2]-t[n-1]*e[n-1]*e[n-1],e[n]=(e[n]-t[n-1]*e[n-1]*r[n-1])/t[n],r[n]=r[n]/t[n];for(let t=2;t<i;++t)n[t]=n[t]-e[t-1]*n[t-1]-r[t-2]*n[t-2];for(let e=1;e<i;++e)n[e]=n[e]/t[e];n[i-2]=n[i-2]-e[i-2]*n[i-1];for(let t=i-3;t>0;--t)n[t]=n[t]-e[t]*n[t+1]-r[t]*n[t+2]})(f,h,p,u),c[0][3]=e[0]-y*a[0]*u[1]*r[0],c[1][3]=e[1]-y*(s[1]*u[1]+a[1]*u[2])*r[0],c[0][0]=u[1]/(3*o[0]),c[0][1]=0,c[0][2]=(c[1][3]-c[0][3])/o[0]-u[1]*o[0]/3,a[0]=0;for(let t=1;t<i;++t)c[t][0]=(u[t+1]-u[t])/(3*o[t]),c[t][1]=u[t],c[t][2]=(u[t]+u[t-1])*o[t-1]+c[t-1][2],c[t][3]=a[t-1]*u[t-1]+s[t]*u[t]+a[t]*u[t+1],c[t][3]=e[t]-y*c[t][3]*r[t];return c})(i,o,s,r)}interpolate(t){if(t===this.x[this.n-1])return this.y[this.n-1];const e=Math.min(Math.max(0,tr(this.x,t)-1),this.n-2),[r,n,i,o]=this.params[e];return r*(t-=this.x[e])*t*t+n*t*t+i*t+o}max(t=100){const e=this.x[0],r=(this.x[this.n-1]-e)/t;let n=-1/0;for(let i=0,o=e;i<t;++i,o+=r){const t=this.interpolate(o);t>n&&(n=t)}return n}min(t=100){const e=this.x[0],r=(this.x[this.n-1]-e)/t;let n=1/0;for(let i=0,o=e;i<t;++i,o+=r){const t=this.interpolate(o);t<n&&(n=t)}return n}domain(){return[this.x[0],this.x[this.x.length-1]]}range(){return[this.min(),this.max()]}curve(t,e=null){const r=((e=e||this.domain())[1]-e[0])/(t-1),n=new Array(t);for(let i=0;i<t;++i){const t=r*i+e[0];n[i]=[t,this.interpolate(t)]}return n}};function rr(t,e={}){const{mask:r,cutOff:n,refine:i=!0,magnitudeMode:o=!1,scaleFactor:a=1,factorStd:s=5,fixOffset:l=!0}=e;let u;if(u=Array.isArray(r)&&r.length===t.length?t.filter((t,e)=>!r[e]):t.slice(),a>1)for(let t=0;t<u.length;t++)u[t]*=a;if(u.sort((t,e)=>e-t),l&&!o){let t=Math.floor(u.length/2),e=.5*(u[t]+u[t+1]);for(let t=0;t<u.length;t++)u[t]-=e}let f=u.findIndex(t=>t<0),h=f-1;for(let t=h;t>=0;t--)if(u[t]>0){h=t;break}let p,c=new Float64Array(u.slice(0,h+1)),y=new Float64Array(u.slice(f)),d=n||function(t,e={}){let{magnitudeMode:r=!1,considerList:n={from:.5,step:.1,to:.9}}=e,i=[],o=t.length-1;for(let e=.01;e<=.99;e+=.01){let n=Math.round(o*e),a=-t[n]/nr([e/2],{magnitudeMode:r});i.push([e,a])}let a=Number.MAX_SAFE_INTEGER,{from:s,to:l,step:u}=n,f=u/2,h=.5;for(let t=s;t<=l;t+=u){let e=t-f,r=t+f,n=i.filter(t=>t[0]<r&&t[0]>e),o=n.reduce((t,e)=>t+Math.abs(e[1]),0),s=0;for(let t=0;t<n.length;t++)s+=Math.pow(n[t][1]-o,2);s<a&&(a=s,h=t)}return h}(c,{magnitudeMode:o}),g=c[Math.floor(c.length*d)],m=c[0];if(y.length>0){p=-1*y[Math.floor(y.length*(1-d))]}else p=0;let v=g,w=p,b=c.slice(),x=y.slice(),A=0,E=2;if(i){let t=v*s;A=c.findIndex(e=>e<t),A>-1&&(b=c.slice(A),v=b[Math.floor(b.length*d)]),t=w*s,E=y.findIndex(e=>e<t),E>-1&&(x=y.slice(E),w=b[Math.floor(x.length*(1-d))])}let O,M,I=-nr(d/2,{magnitudeMode:o});return g/=I,p/=I,i&&A>-1?(O=(d*b.length+A)/(b.length+A),M=-1*nr(O/2,{magnitudeMode:o}),v/=M,E>-1&&(O=(d*x.length+E)/(x.length+E),M=-1*nr(O/2,{magnitudeMode:o}),0!==w&&(w/=M))):(v/=I,w/=I),{positive:v,negative:w,snr:m/v}}function nr(t,e={}){const{magnitudeMode:r=!1}=e;Array.isArray(t)||(t=[t]);let n=function(t,e,r){let n=new Float32Array(Math.abs((t-e)/r+1));for(let e=0;e<n.length;e++)n[e]=t+e*r;return Array.from(n)}(0,2,.01),i=new Float64Array(t.length),o=new Float64Array(n.length);if(r){let e=1;for(let t=0;t<o.length;t++){let r=n[t]*e;o[t]=1-He(r)}let r=new er(n,o);for(let e=0;e<i.length;e++){let n=2*t[e];i[e]=-1*r.interpolate(n)}}else for(let e=0;e<i.length;e++)i[e]=-1*Math.SQRT2*ze(2*t[e]);return 1===i.length?i[0]:i}function ir(t,e={}){let{target:r,targetIndex:n}=e;return void 0===n?void 0!==r?l(t,r):0:n}function or(t,e){(e%=t.length)<0&&(e+=t.length);let r=new Float64Array(t.length);return r.set(t.slice(t.length-e)),r.set(t.slice(0,t.length-e),e),r}function ar(t){const e=t.re.length,r=t.re,n=t.im,i=new Float64Array(e);for(let t=0;t<e;t++)i[t]=Math.sqrt(r[t]**2+n[t]**2);return i}function sr(t,e,r){e=Number.isFinite(e)?e:0,r=Number.isFinite(r)?r:0;const n=t.re,i=t.im,o=t.re.length,a=r/o,s=2*Math.pow(Math.sin(a/2),2),l=Math.sin(a);let u=Math.cos(e),f=Math.sin(e);const h=new Float64Array(o),p=new Float64Array(o);for(let t=0;t<o;t++){h[t]=n[t]*u-i[t]*f,p[t]=n[t]*f+i[t]*u;let e=f-(s*f-l*u);u=u-(s*u+l*f),f=e}return{re:h,im:p}}const lr={minRegSize:30,maxDistanceToJoin:256,magnitudeMode:!0,factorNoise:3};function ur(t,e,r){let n=-180,i=180,o=5,a=0,s=Number.MAX_SAFE_INTEGER;for(;o>0;){let r=(i-n)/7;for(let o=n;o<=i;o+=r){let r=sr({re:t,im:e},hr(o),0),n=pr(r.re);n<s&&([s,a]=[n,o])}n=a-r,i=a+r,o--}let l=sr({re:t,im:e},hr(a),0),u=0,f=0;for(let e=0;e<t.length;e++)u+=l.re[e],f+=l.re[e]*(e+r);return{ph0:a,area:u,x0:f/u}}function fr(t,e){const{maxDistanceToJoin:r,magnitudeMode:n,factorNoise:i}=e;let o=new Array(t.length);for(let e=0;e<t.length;e++)o[e]=!1;let a=!0;for(;a;){let e=i*rr(t,{magnitudeMode:n}).positive;a=!1;for(let r=0;r<t.length;r++)Math.abs(t[r])>e&&!o[r]&&(a=!0,o[r]=!0)}let s=0,l=0;for(let e=0;e<t.length;e++)if(o[e]){if(s<r)for(let t=0;t<=s;t++)o[l+t]=!0;for(;o[++e]&&e<t.length;);l=e,s=0}else s++;return o}const hr=t=>t*Math.PI/180,pr=t=>{let e=0;for(let r=0;r<t.length;r++)t[r]<0&&(e-=t[r]);return e};function cr(t){if(this.size=0|t,this.size<=1||0!=(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),r=0;r<e.length;r+=2){const t=Math.PI*r/this.size;e[r]=Math.cos(t),e[r+1]=-Math.sin(t)}this.table=e;for(var n=0,i=1;this.size>i;i<<=1)n++;this._width=n%2==0?n-1:n,this._bitrev=new Array(1<<this._width);for(var o=0;o<this._bitrev.length;o++){this._bitrev[o]=0;for(var a=0;a<this._width;a+=2){var s=this._width-a-2;this._bitrev[o]|=(o>>>a&3)<<s}}this._out=null,this._data=null,this._inv=0}var yr=cr;cr.prototype.fromComplexArray=function(t,e){for(var r=e||new Array(t.length>>>1),n=0;n<t.length;n+=2)r[n>>>1]=t[n];return r},cr.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},cr.prototype.toComplexArray=function(t,e){for(var r=e||this.createComplexArray(),n=0;n<r.length;n+=2)r[n]=t[n>>>1],r[n+1]=0;return r},cr.prototype.completeSpectrum=function(t){for(var e=this._csize,r=e>>>1,n=2;n<r;n+=2)t[e-n]=t[n],t[e-n+1]=-t[n+1]},cr.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},cr.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},cr.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var r=0;r<t.length;r++)t[r]/=this.size;this._out=null,this._data=null},cr.prototype._transform4=function(){var t,e,r=this._out,n=this._csize,i=1<<this._width,o=n/i<<1,a=this._bitrev;if(4===o)for(t=0,e=0;t<n;t+=o,e++){const r=a[e];this._singleTransform2(t,r,i)}else for(t=0,e=0;t<n;t+=o,e++){const r=a[e];this._singleTransform4(t,r,i)}var s=this._inv?-1:1,l=this.table;for(i>>=2;i>=2;i>>=2){var u=(o=n/i<<1)>>>2;for(t=0;t<n;t+=o)for(var f=t+u,h=t,p=0;h<f;h+=2,p+=i){const t=h,e=t+u,n=e+u,i=n+u,o=r[t],a=r[t+1],f=r[e],c=r[e+1],y=r[n],d=r[n+1],g=r[i],m=r[i+1],v=o,w=a,b=l[p],x=s*l[p+1],A=f*b-c*x,E=f*x+c*b,O=l[2*p],M=s*l[2*p+1],I=y*O-d*M,j=y*M+d*O,T=l[3*p],N=s*l[3*p+1],_=g*T-m*N,P=g*N+m*T,S=v+I,F=w+j,V=v-I,k=w-j,z=A+_,C=E+P,U=s*(A-_),R=s*(E-P),$=S+z,D=F+C,q=S-z,Y=F-C,L=V+R,G=k-U,X=V-R,B=k+U;r[t]=$,r[t+1]=D,r[e]=L,r[e+1]=G,r[n]=q,r[n+1]=Y,r[i]=X,r[i+1]=B}}},cr.prototype._singleTransform2=function(t,e,r){const n=this._out,i=this._data,o=i[e],a=i[e+1],s=i[e+r],l=i[e+r+1],u=o+s,f=a+l,h=o-s,p=a-l;n[t]=u,n[t+1]=f,n[t+2]=h,n[t+3]=p},cr.prototype._singleTransform4=function(t,e,r){const n=this._out,i=this._data,o=this._inv?-1:1,a=2*r,s=3*r,l=i[e],u=i[e+1],f=i[e+r],h=i[e+r+1],p=i[e+a],c=i[e+a+1],y=i[e+s],d=i[e+s+1],g=l+p,m=u+c,v=l-p,w=u-c,b=f+y,x=h+d,A=o*(f-y),E=o*(h-d),O=g+b,M=m+x,I=v+E,j=w-A,T=g-b,N=m-x,_=v-E,P=w+A;n[t]=O,n[t+1]=M,n[t+2]=I,n[t+3]=j,n[t+4]=T,n[t+5]=N,n[t+6]=_,n[t+7]=P},cr.prototype._realTransform4=function(){var t,e,r=this._out,n=this._csize,i=1<<this._width,o=n/i<<1,a=this._bitrev;if(4===o)for(t=0,e=0;t<n;t+=o,e++){const r=a[e];this._singleRealTransform2(t,r>>>1,i>>>1)}else for(t=0,e=0;t<n;t+=o,e++){const r=a[e];this._singleRealTransform4(t,r>>>1,i>>>1)}var s=this._inv?-1:1,l=this.table;for(i>>=2;i>=2;i>>=2){var u=(o=n/i<<1)>>>1,f=u>>>1,h=f>>>1;for(t=0;t<n;t+=o)for(var p=0,c=0;p<=h;p+=2,c+=i){var y=t+p,d=y+f,g=d+f,m=g+f,v=r[y],w=r[y+1],b=r[d],x=r[d+1],A=r[g],E=r[g+1],O=r[m],M=r[m+1],I=v,j=w,T=l[c],N=s*l[c+1],_=b*T-x*N,P=b*N+x*T,S=l[2*c],F=s*l[2*c+1],V=A*S-E*F,k=A*F+E*S,z=l[3*c],C=s*l[3*c+1],U=O*z-M*C,R=O*C+M*z,$=I+V,D=j+k,q=I-V,Y=j-k,L=_+U,G=P+R,X=s*(_-U),B=s*(P-R),Q=$+L,K=D+G,J=q+B,W=Y-X;if(r[y]=Q,r[y+1]=K,r[d]=J,r[d+1]=W,0!==p){if(p!==h){var H=q+-s*B,Z=-Y+-s*X,tt=$+-s*L,et=-D- -s*G,rt=t+f-p,nt=t+u-p;r[rt]=H,r[rt+1]=Z,r[nt]=tt,r[nt+1]=et}}else{var it=$-L,ot=D-G;r[g]=it,r[g+1]=ot}}}},cr.prototype._singleRealTransform2=function(t,e,r){const n=this._out,i=this._data,o=i[e],a=i[e+r],s=o+a,l=o-a;n[t]=s,n[t+1]=0,n[t+2]=l,n[t+3]=0},cr.prototype._singleRealTransform4=function(t,e,r){const n=this._out,i=this._data,o=this._inv?-1:1,a=2*r,s=3*r,l=i[e],u=i[e+r],f=i[e+a],h=i[e+s],p=l+f,c=l-f,y=u+h,d=o*(u-h),g=p+y,m=c,v=-d,w=p-y,b=c,x=d;n[t]=g,n[t+1]=0,n[t+2]=m,n[t+3]=v,n[t+4]=w,n[t+5]=0,n[t+6]=b,n[t+7]=x};const dr=(t,e)=>or(t,e?Math.ceil(t.length/2):Math.floor(t.length/2));const gr=Object.prototype.toString;function mr(t){return gr.call(t).endsWith("Array]")}function vr(t={}){if(!mr(t.x)||!mr(t.y))throw new Error("Points must be an object of x and y arrays");if(t.x.length!==t.y.length)throw new Error("The x and y arrays mush have the same length")}function wr(t=[],e={}){if(0===t.length)return[];t=JSON.parse(JSON.stringify(t)).map(t=>t.from>t.to?{from:t.to,to:t.from}:t);let{from:r=Number.NEGATIVE_INFINITY,to:n=Number.POSITIVE_INFINITY}=e;if(r>n&&([r,n]=[n,r]),(t=t.sort((t,e)=>t.from!==e.from?t.from-e.from:t.to-e.to)).forEach(t=>{r>t.from&&(t.from=r),n<t.to&&(t.to=n)}),0===(t=t.filter(t=>t.from<=t.to)).length)return[];let i=t[0],o=[i];for(let e of t)e.from<=i.to?i.to=e.to:(i=e,o.push(i));return o}t.reimAbsolute=ar,t.reimAutoPhaseCorrection=function(t,e={}){const{re:r,im:n}=t,i=r.length;e=Object.assign(lr,e);const{magnitudeMode:o,minRegSize:a}=e;let s=o?ar(t):r,l=fr(function(t){let e=new Float64Array(t.length);for(let r=5;r<t.length-5;r++)e[r]=(42*(t[r+1]-t[r-1])+48*(t[r+2]-t[r-2])+27*(t[r+3]+t[r-3])+8*(t[r+4]-t[r-4])+t[r+5]-t[r-5])/512;for(let r=0;r<5;r++)e[r]=e[5],e[t.length-r-1]=e[t.length-6];return e}(s),e),u=fr(s,e),f=new Array(i);for(let t=0;t<i;t++)f[t]=u[t]&l[t];let h=-1,p=0,c=[];for(;h<i;){let t=[],e=[];for(;!f[++h]&&h<i;)p=h;for(;f[h]&&h<i;h++)t.push(r[h]),e.push(n[h]),h++;t.length>a&&c.push(ur(t,e,p))}let[y,d]=function(t,e,r){let n=0,i=0,o=0,a=0,s=0;for(let l=0;l<t.length;l++)n+=t[l]*t[l]*r[l],i+=t[l]*r[l],o+=r[l],a+=t[l]*r[l]*e[l],s+=r[l]*e[l];let l=n*o-i*i,u=[[o/l,-i/l],[-i/l,n/l]];return[u[0][0]*a+u[0][1]*s,u[1][0]*a+u[1][1]*s]}(c.map(t=>t.x0/i),c.map(t=>t.ph0),c.map(t=>t.area/1e11));return{data:sr({re:r,im:n},d*Math.PI/180,y*Math.PI/180),ph0:d,ph1:y}},t.reimFFT=function(t,e={}){const{inverse:r=!1,applyZeroShift:n=!1}=e;let{re:i,im:o}=t;const a=i.length,s=a<<1;let l=new Float64Array(s);for(let t=0;t<s;t+=2)l[t]=i[t>>>1],l[t+1]=o[t>>>1];let u=new yr(a),f=new Float64Array(s);r?(n&&(l=dr(l,!0)),u.inverseTransform(f,l)):(u.transform(f,l),n&&(f=dr(f)));let h=new Float64Array(a),p=new Float64Array(a);for(let t=0;t<s;t+=2)h[t>>>1]=f[t],p[t>>>1]=f[t+1];return{re:h,im:p}},t.reimPhaseCorrection=sr,t.xAbsoluteMedian=function(t){let e=t.slice();for(let t=0;t<e.length;t++)e[t]=Math.abs(e[t]);return function(t){if(!r(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");return i(t.slice())}(e)},t.xAdd=function(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]+r;else for(let r=0;r<t.length;r++)i[r]=t[r]+e[r];return i},t.xAutoCorrelation=function(t,e={}){return s(t,t,e)},t.xBoxPlot=function(t){if((t=t.slice(0).sort((t,e)=>t-e)).length<5)throw Error("xBoxPlot: can not calculate info if array contains less than 3 elements");let e,r,n={Q1:0,Q2:0,Q3:0,min:t[0],max:t[t.length-1]};if(t.length%2==1){let i=(t.length-1)/2;n.Q2=t[i],e=i-1,r=i+1}else r=t.length/2,e=r-1,n.Q2=(t[e]+t[r])/2;if(e%2==0)n.Q1=t[e/2],n.Q3=t[(t.length+r-1)/2];else{n.Q1=(t[(e+1)/2]+t[(e-1)/2])/2;let i=(t.length+r)/2;n.Q3=(t[i]+t[i-1])/2}return n},t.xCorrelation=function(t,e){let r=t.length,n=0,i=0,o=0,a=0,s=0;for(let l=0;l<r;l++){let r=t[l],u=e[l];n+=r,i+=r**2,o+=u,a+=u**2,s+=r*u}return(r*s-n*o)/(Math.sqrt(r*i-n**2)*Math.sqrt(r*a-o**2))},t.xCrossCorrelation=s,t.xDivide=function(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]/r;else for(let r=0;r<t.length;r++)i[r]=t[r]/e[r];return i},t.xFindClosestIndex=l,t.xGetFromToIndex=u,t.xGetTargetIndex=ir,t.xMultiply=o,t.xNoiseSanPlot=rr,t.xRotate=or,t.xSubtract=function(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]-r;else for(let r=0;r<t.length;r++)i[r]=t[r]-e[r];return i},t.xreimSortX=function(t){const{x:e,re:r,im:n}=t;if(e.length!==r.length||e.length!==n.length)throw TypeError("xreimSortX: length of x, re and im must be identical");return e.length<2||e[0]<e[1]?t:{x:e.slice(0).reverse(),re:r.slice(0).reverse(),im:n.slice(0).reverse()}},t.xreimZeroFilling=function(t,e){let r=t.x.length;if(0===e||r===e)return t;if(r>e)return{x:t.x.slice(0,e),re:t.re.slice(0,e),im:t.im.slice(0,e)};const n=t.x,i=t.re,o=t.im,a=new Float64Array(e),s=new Float64Array(e),l=new Float64Array(e);for(let t=0;t<r;t++)a[t]=n[t],s[t]=i[t],l[t]=o[t];const u=(n[n.length-1]-n[0])/(r-1);for(let t=r;t<e;t++)a[t]=a[t-1]+u;return{x:a,re:s,im:l}},t.xyAlign=function(t,e,r={}){const{delta:n=1,common:i=!0,x:o="x1",weightFunction:a}=r;let s={x:[],y1:[],y2:[]},l=0,u=0,f=t.x.length,h=e.x.length;for(;l<t.x.length&&u<e.x.length;){let r=0;if("function"==typeof a){r=a((t.x[l]+e.x[u])/2)}else r=n;let p=t.x[l]-e.x[u];if(Math.abs(p)>r)if(p>0){if(!i&&(s.x.push(e.x[u]),s.y1.push(0),s.y2.push(e.y[u]),u===h-1))for(;l<t.x.length;)s.x.push(t.x[l]),s.y1.push(t.y[l]),s.y2.push(0),l++;u++}else{if(!i&&(s.x.push(t.x[l]),s.y1.push(t.y[l]),s.y2.push(0),l===f-1))for(;u<e.x.length;)s.x.push(e.x[u]),s.y1.push(0),s.y2.push(e.y[u]),u++;l++}else{let r=(t.x[l]*t.y[l]+e.x[u]*e.y[u])/(t.y[l]+e.y[u]);switch(o){case"x1":s.x.push(t.x[l]);break;case"x2":s.x.push(e.x[u]);break;case"weighted":s.x.push(r);break;default:throw new Error("Error: Unknown x option value: "+o)}s.y1.push(t.y[l]),s.y2.push(e.y[u]),l++,u++}}return s},t.xyCheck=vr,t.xyExtract=function(t={},e={}){vr(t);const{x:r,y:n}=t;let{zones:i}=e;if(i=wr(i),!Array.isArray(i)||0===i.length)return t;let o=[],a=[],s=i[0],l=0;t:for(let t=0;t<r.length;t++){for(;s.to<r[t];)if(l++,s=i[l],!s){t=r.length;break t}r[t]>=s.from&&(o.push(r[t]),a.push(n[t]))}return{x:o,y:a}},t.xyGetNMaxY=function(t,e){if(vr(t),t.x.length<=e)return t;{let r=new Array(e),n=new Array(e),i=t.y.slice().sort((t,e)=>e-t)[e-1],o=0;for(let a=0;a<t.x.length;a++)if(t.y[a]>=i&&(r[o]=t.x[a],n[o]=t.y[a],o++),o===e)return{x:r,y:n}}},t.xyGrowingX=function(t){const{x:e,y:r}=t;if(e.length!==r.length)throw TypeError("sortX: length of x and y must be identical");return e.length<2||e[0]<e[1]?t:{x:e.slice(0).reverse(),y:r.slice(0).reverse()}},t.xyIntegral=function(t={},e={}){const{reverse:r=!1}=e;vr(t);const{x:n,y:i}=t;if(n.length<2)return 0;const{fromIndex:o,toIndex:a}=u(n,e);let s,l=0;if(r){s={x:[n[a]],y:[0]};for(let t=a;t>o;t--)l+=(n[t]-n[t-1])*(i[t-1]+i[t])/2,s.x.push(n[t-1]),s.y.push(l);s.x.reverse(),s.y.reverse()}else{s={x:[n[o]],y:[0]};for(let t=o;t<a;t++)l+=(n[t+1]-n[t])*(i[t+1]+i[t])/2,s.x.push(n[t+1]),s.y.push(l)}return s},t.xyIntegration=function(t={},e={}){vr(t);const{x:r,y:n}=t;if(r.length<2)return 0;const{fromIndex:i,toIndex:o}=u(r,e);let a=0;for(let t=i;t<o;t++)a+=(r[t+1]-r[t])*(n[t+1]+n[t])/2;return a},t.xyMaxClosestYPoint=function(t,e={}){vr(t);const{x:r,y:n}=t;let{target:i,targetIndex:o}=e;void 0===o&&(o=void 0!==i?l(r,i):0);let a=Number.MIN_SAFE_INTEGER,s=o,u=n[o];for(;s!==a;)a=s,s>0&&n[s-1]>u?s--:s<r.length-1&&n[s+1]>u&&s++,u=n[s];return{x:r[s],y:n[s],index:s}},t.xyMaxY=function(t={},e={}){vr(t);const{x:r,y:n}=t;if(r.length<2)return 0;const{fromIndex:i,toIndex:o}=u(r,e);let a=n[i];for(let t=i;t<=o;t++)n[t]>a&&(a=n[t]);return a},t.xyMaxYPoint=function(t={},e={}){vr(t);const{x:r,y:n}=t;if(r.length<2)return 0;const{fromIndex:i,toIndex:o}=u(r,e);let a={x:r[i],y:n[i],index:i};for(let t=i;t<=o;t++)n[t]>a.y&&(a={x:r[t],y:n[t],index:t});return a},t.xyMaximaY=function(t={}){vr(t);const{x:e,y:r}=t;if(e.length<3)return[];let n=[],i=-1;for(let t=1;t<e.length-1;t++)if(r[t-1]<r[t]&&r[t+1]<r[t])n.push({x:e[t],y:r[t],index:t});else if(r[t-1]<r[t]&&r[t+1]===r[t])i=t;else if(r[t-1]===r[t]&&r[t+1]<r[t]){let o=(t+i)/2>>0;n.push({x:e[o],y:r[o],index:o})}return n},t.xyMinClosestYPoint=function(t,e={}){vr(t);const{x:r,y:n}=t;let{target:i,targetIndex:o}=e;void 0===o&&(o=void 0!==i?l(r,i):0);let a=Number.MIN_SAFE_INTEGER,s=o,u=n[o];for(;s!==a;)a=s,s>0&&n[s-1]<u?s--:s<r.length-1&&n[s+1]<u&&s++,u=n[s];return{x:r[s],y:n[s],index:s}},t.xyMinYPoint=function(t={},e={}){vr(t);const{x:r,y:n}=t;if(r.length<2)return 0;const{fromIndex:i,toIndex:o}=u(r,e);let a={x:r[i],y:n[i],index:i};for(let t=i;t<=o;t++)n[t]<a.y&&(a={x:r[t],y:n[t],index:t});return a},t.xyMinimaY=function(t={}){vr(t);const{x:e,y:r}=t;if(e.length<3)return[];let n=[],i=-1;for(let t=1;t<e.length-1;t++)if(r[t-1]>r[t]&&r[t+1]>r[t])n.push({x:e[t],y:r[t],index:t});else if(r[t-1]>r[t]&&r[t+1]===r[t])i=t;else if(r[t-1]===r[t]&&r[t+1]>r[t]){let o=(t+i)/2>>0;n.push({x:e[o],y:r[o],index:o})}return n},t.xyObjectJoinX=function(t,e={}){const{xError:r=Number.EPSILON}=e;let n=[],i={x:Number.MIN_SAFE_INTEGER,y:0};for(let e of t)e.x-i.x<=r?(i.x=e.y/(i.y+e.y)*(e.x-i.x)+i.x,i.y+=e.y):(i={x:e.x,y:e.y},n.push(i));return n},t.xyObjectSlotX=function(t,e={}){const{slotWidth:r=1}=e,n=r/2;let i=[],o={x:Number.MIN_VALUE,y:0};for(let e of t){let t=e.x-(e.x+n)%r+n;Math.abs(o.x-t)>Number.EPSILON&&(o={x:t,y:0},i.push(o)),o.y+=e.y}return i},t.xyObjectSortX=function(t){return t.sort((t,e)=>t.x-e.x)},t.xyObjectToXY=function(t){return{x:t.map(t=>t.x),y:t.map(t=>t.y)}},t.xyPeakInfo=function(t={},e={}){vr(t);const{x:r,y:n}=t;if(r.length<3)return;let{targetIndex:i,target:o}=e;if(void 0===i&&void 0!==o&&(i=l(r,o)),void 0===i)throw new Error("xyPeakInfo: need to specify target or targetIndex");let a=i,s=n[a]-n[a+1],u=s<0?-1:1;for(s*=u;a<r.length-1;){a++;let t=(n[a]-n[a+1])*u;if(t<s)break;s=t}let f={x:r[a],y:n[a]};for(a=i,s=(n[a]-n[a-1])*u;a>1;){a--;let t=(n[a]-n[a-1])*u;if(t<s)break;s=t}let h={x:r[a],y:n[a]};return{inflectionBefore:h,inflectionAfter:f,extrema:{x:r[i],y:n[i]},inflectionMiddle:{x:(h.x+f.x)/2,y:(h.y+f.y)/2},width:Math.abs(h.x-f.x)}},t.xyRealMaxYPoint=function(t,e={}){vr(t);const{x:r,y:n}=t,i=ir(r,e);if(n[i-1]>0&&n[i+1]>0&&n[i]>=n[i-1]&&n[i]>=n[i+1]){let t=20*Math.log10(n[i-1]),e=20*Math.log10(n[i]),o=20*Math.log10(n[i+1]),a=.5*(t-o)/(t-2*e+o);return{x:r[i]+(r[i]-r[i-1])*a,y:n[i]-.25*(n[i-1]-n[i+1])*a,index:i}}return{x:r[i],y:n[i],index:i}},t.xyRealMinYPoint=function(t,e={}){vr(t);const{x:r,y:n}=t,i=ir(r,e);if(n[i-1]<0&&n[i+1]<0&&n[i]<=n[i-1]&&n[i]<=n[i+1]){let t=20*Math.log10(-n[i-1]),e=20*Math.log10(-n[i]),o=20*Math.log10(-n[i+1]),a=.5*(t-o)/(t-2*e+o);return{x:r[i]+(r[i]-r[i-1])*a,y:n[i]-.25*(n[i-1]-n[i+1])*a,index:i}}return{x:r[i],y:n[i],index:i}},t.xyReduce=function(t,e={}){vr(t);const{x:r,y:n}=t;let{from:i=r[0],to:o=r[r.length-1],nbPoints:a=4001,optimize:s=!1,zones:u=[]}=e;u=wr(u,{from:i,to:o}),0===u.length&&(u=[{from:i,to:o}]);let f=0;for(let t of u)t.fromIndex=l(r,t.from),t.toIndex=l(r,t.to),t.fromIndex>0&&r[t.fromIndex]>t.from&&t.fromIndex--,t.toIndex<r.length-1&&r[t.toIndex]<t.to&&t.toIndex++,t.nbPoints=t.toIndex-t.fromIndex+1,f+=t.nbPoints;if(!(f>a)){let t=new Float64Array(f),e=new Float64Array(f),i=0;for(let o of u)for(let a=o.fromIndex;a<o.toIndex+1;a++)t[i]=r[a],e[i]=n[a],i++;return{x:t,y:e}}{let t=a/f,e=0;for(let r=0;r<u.length-1;r++){const n=u[r];n.nbPoints=Math.round(n.nbPoints*t),e+=n.nbPoints}u[u.length-1].nbPoints=a-e}let h=[],p=[];for(let t of u)t.nbPoints&&c(t.fromIndex,t.toIndex,t.nbPoints);return{x:h,y:p};function c(t,e,i){if(1===i)return h.push(r[Math.round((e-t)/2)]),void p.push(n[Math.round((e-t)/2)]);if(2===i)return h.push(r[t],r[e]),void p.push(n[t],n[e]);h.push(r[t]),p.push(n[t]);let o=Number.MAX_VALUE,a=Number.MIN_VALUE;i=i%2==0?i/2+1:(i-1)/2+1;let l=(r[e]-r[t])/(i-1),u=r[t]+l,f=!0;for(let i=t+1;i<=e;i++)f?(o=n[i],a=n[i],f=!1):(n[i]<o&&(o=n[i]),n[i]>a&&(a=n[i])),(r[i]>=u||i===e)&&(s?o>p[h.length-1]||(a<p[h.length-1]?a=o:(h.push(u-l/2),p.push(o))):(h.push(u-l/2),p.push(o)),h.push(u),p.push(a),u+=l,f=!0)}},t.xyToXYObject=function(t){vr(t);const{x:e,y:r}=t;let n=[];for(let t=0;t<e.length;t++)n.push({x:e[t],y:r[t]});return n},t.zoneToX=function(t,e){const{from:r,to:n}=t;let i=new Float64Array(e),o=(n-r)/(e-1);for(let t=0;t<e;t++)i[t]=r+o*t;return i},t.zonesNormalize=wr,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ml-spectra-processing.min.js.map
